import{L as e,R as t,T as n,c as r,f as i,h as a,j as o,m as s,n as c,o as l,p as u,t as d,u as f}from"./app-DvX1Smg_.js";import"./isObject-STXFNBUz.js";import"./isSymbol-CUbBZ03s.js";import"./toNumber-CiYTsHHK.js";import"./now-BXsIGwzm.js";import{n as p,t as m}from"./toc-DNILfFl5.js";import{n as h,t as g}from"./meta-info-C-tMy3g2.js";import{t as _}from"./use-page-title-CHxbaOlI.js";var v={class:`relative`},y={key:0,class:`mt-10`},b=l(Object.assign({name:`Article`},{__name:`vm:_post_inno-setup_`,setup(l){_({title:`Inno Setup`,description:`Inno Setup 初学者的整理文档，覆盖了 ISS 脚本中的大部分 Section。`});let{meta:b,toc:x}={meta:{title:`Inno Setup`,date:`2023-04-07T11:28:06.000Z`,id:`inno-setup`,description:`Inno Setup 初学者的整理文档，覆盖了 ISS 脚本中的大部分 Section。`,tags:[`Inno Setup`],sort:0,comments:!0,draft:!1},toc:[{id:`%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5`,text:`安装 & 起步`,level:2,children:[],parent:``},{id:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`,text:`脚本学习`,level:2,children:[{id:`iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88`,text:`iss 脚本概览`,level:3,children:[],parent:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`},{id:`%E5%A4%9A%E8%AF%AD%E8%A8%80`,text:`多语言`,level:3,children:[],parent:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`},{id:`%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89`,text:`常量（Constants）`,level:3,children:[],parent:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`},{id:`%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89`,text:`公共参数（Common Parameters）`,level:3,children:[],parent:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`},{id:`Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`,text:`Components 和 Tasks 参数`,level:3,children:[{id:`Components%20%E5%8F%82%E6%95%B0`,text:`Components 参数`,level:4,children:[],parent:`Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`},{id:`Tasks%20%E5%8F%82%E6%95%B0`,text:`Tasks 参数`,level:4,children:[],parent:`Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`},{id:`%E5%B0%9D%E8%AF%95`,text:`尝试`,level:4,children:[],parent:`Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`}],parent:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`}],parent:``},{id:`Sections%20%E5%AD%A6%E4%B9%A0`,text:`Sections 学习`,level:2,children:[{id:`%5BSetup%5D`,text:`[Setup]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BTypes%5D`,text:`[Types]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BComponents%5D`,text:`[Components]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BDirs%5D`,text:`[Dirs]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BFiles%5D`,text:`[Files]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BIcons%5D`,text:`[Icons]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BRegistry%5D`,text:`[Registry]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`},{id:`%5BRun%5D%20%26%20%5BUninstallRun%5D`,text:`[Run] & [UninstallRun]`,level:3,children:[],parent:`Sections%20%E5%AD%A6%E4%B9%A0`}],parent:``},{id:`Pascal%20%E8%84%9A%E6%9C%AC`,text:`Pascal 脚本`,level:2,children:[{id:`%5BCode%5D`,text:`[Code]`,level:3,children:[{id:`%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0`,text:`事件函数`,level:4,children:[],parent:`%5BCode%5D`},{id:`%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F`,text:`脚本常量`,level:4,children:[],parent:`%5BCode%5D`},{id:`Check%20%E5%8F%82%E6%95%B0`,text:`Check 参数`,level:4,children:[],parent:`%5BCode%5D`},{id:`BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0`,text:`BeforeInstall & AfterInstall 参数`,level:4,children:[],parent:`%5BCode%5D`},{id:`%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86`,text:`调用 DLLs 和 .Net 程序集`,level:4,children:[],parent:`%5BCode%5D`},{id:`%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects`,text:`使用 COM Automation Objects`,level:4,children:[],parent:`%5BCode%5D`}],parent:`Pascal%20%E8%84%9A%E6%9C%AC`}],parent:``},{id:`%E7%BB%93%E8%AF%AD`,text:`结语`,level:2,children:[],parent:``}]},{appState:S}=d();return(l,d)=>(n(),u(r,null,[f(`div`,v,[f(`article`,null,[f(`header`,null,[d[1]||=f(`h1`,{class:`text-foreground text-3xl font-bold mb-4`},` Inno Setup `,-1),a(g,{meta:e(b)},null,8,[`meta`])]),a(h,{class:`mt-6`},{default:o(()=>[d[28]||=f(`p`,null,`最近工作上遇到了 Inno Setup，这对于我来说是个新东西，看不懂，那么就学一下吧。`,-1),d[29]||=f(`a`,{id:`more`,href:`#more`,class:`block`},null,-1),d[30]||=f(`h2`,{id:`%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5`},[s(`安装 & 起步`),f(`a`,{name:`%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5`,class:`headerlink`,href:`#%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5`})],-1),d[31]||=f(`blockquote`,null,[f(`p`,null,`当前所使用的 Inno Setup 版本是 6.2.2`)],-1),f(`p`,null,[d[3]||=s(`Inno Setup（后文将简称为 Inno） 是一个开源的安装包制作工具，小巧但强大，官网下载地址：`,-1),a(c,{target:`_blank`,href:`https://jrsoftware.org/isinfo.php`},{default:o(()=>[...d[2]||=[s(`https://jrsoftware.org/isinfo.php`,-1)]]),_:1}),d[4]||=s(`。`,-1)]),f(`p`,null,[d[6]||=s(`官方文档：`,-1),a(c,{target:`_blank`,href:`https://jrsoftware.org/ishelp/`},{default:o(()=>[...d[5]||=[s(`https://jrsoftware.org/ishelp/`,-1)]]),_:1})]),d[32]||=f(`p`,null,`下载安装之后打开 Inno，实际上是一个编辑器，可以直接编辑脚本，可以编译、运行脚本，生成安装程序。`,-1),d[33]||=f(`p`,null,`选择新建脚本，写入以下内容：`,-1),d[34]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Setup]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`My Program`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppVersion`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`1.0.0`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`DefaultDirName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{userdesktop}\\hello`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`)])])],-1),d[35]||=f(`p`,null,[s(`点击编译（Compile），在对话框中选择保存脚本（比如 hello.iss），之后在脚本的同级会生成一个 `),f(`code`,null,`Output`),s(`，里面有一个 `),f(`code`,null,`mysetup.exe`),s(`。`)],-1),d[36]||=f(`p`,null,[s(`双击 `),f(`code`,null,`mysetup.exe`),s(` 就开始安装引导了：`)],-1),d[37]||=f(`p`,null,[f(`img`,{alt:`01-hello-installer.png`,loading:`lazy`,title:`01-hello-installer.png`,class:`post-image`,src:`/assets/01-hello-installer-un02f50d.png`,onerror:`this.onerror=null;this.src='/images/image-error.jpg';`})],-1),d[38]||=f(`p`,null,`回顾上述脚本：`,-1),d[39]||=f(`ul`,null,[f(`li`,null,[f(`code`,null,`[Setup]`),s(`：此部分包含安装程序和卸载程序使用的全局设置，该 `),f(`code`,null,`Section`),s(` 是必须的`)]),f(`li`,null,[f(`code`,null,`AppName`),s(` 和 `),f(`code`,null,`AppVersion`),s(` 分别定义应用程序的名称和版本`)]),f(`li`,null,[f(`code`,null,`DefaultDirName`),s(` 是默认的安装目录，这里使用了一个`),f(`strong`,null,`常量`),s(),f(`code`,null,`userdesktop`),s(`，表示用户桌面的路径`)])],-1),d[40]||=f(`p`,null,`根据安装引导的提示完成安装，最终会在指定路径创建一个文件夹，包含如下卸载程序：`,-1),d[41]||=f(`ul`,null,[f(`li`,null,`unins000.dat`),f(`li`,null,`unins000.exe`)],-1),d[42]||=f(`p`,null,`除了手写脚本，Inno 本身自带可视化的界面去制作安装程序，在可视化界面中一步步进行下去，最后可以将一系列操作保存为一份脚本。可视化的操作很方便易学，不过这里不对可视化操作进行过多介绍了，主要还是学习一下脚本的编写。`,-1),d[43]||=f(`h2`,{id:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`},[s(`脚本学习`),f(`a`,{name:`%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`,class:`headerlink`,href:`#%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0`})],-1),d[44]||=f(`h3`,{id:`iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88`},[s(`iss 脚本概览`),f(`a`,{name:`iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88`,class:`headerlink`,href:`#iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88`})],-1),d[45]||=f(`p`,null,[s(`每一个 iss 脚本由若干个 `),f(`code`,null,`Section`),s(` 组成，每个 `),f(`code`,null,`Section`),s(` 有各自的职责。一个 `),f(`code`,null,`Section`),s(` 由方括号 `),f(`code`,null,`[]`),s(` 包裹，其中包含 `),f(`code`,null,`Section`),s(` 的名称。在每个 `),f(`code`,null,`Section`),s(` 内可以包含任意数量的条目。`)],-1),d[46]||=f(`p`,null,[f(`code`,null,`Section`),s(` 可以分为两类：`)],-1),d[47]||=f(`ul`,null,[f(`li`,null,[s(`像 `),f(`code`,null,`[Setup]`),s(` 这样，它的条目由指令名称和值（形式为 Directive=Value）构成`)]),f(`li`,null,[s(`以及像 `),f(`code`,null,`[Files]`),s(` 这样，它的条目是由多个键值对通过分号连接而成，这种形式下的键值对又称为参数（Parameter）`)])],-1),d[48]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Setup]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`My Program`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Files]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.EXE`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"`)])])],-1),d[49]||=f(`blockquote`,null,[f(`p`,null,`注意：`),f(`ul`,null,[f(`li`,null,[s(`每个 `),f(`code`,null,`Section`),s(` 内部的条目可以使用相同的名称`)]),f(`li`,null,[s(`可以存在多个同名 `),f(`code`,null,`Section`)]),f(`li`,null,[s(`默认情况下，指令值中的任何前导或尾随空格都将被删除。可以通过在指令值周围加上双引号 `),f(`code`,null,`"`),s(` 来避免`)]),f(`li`,null,`iss 本身大小写不敏感，但是需要注意有些“值”的书写方式，比如应用名称会在某些地方直接展示给用户，故不可随意书写`)])],-1),d[50]||=f(`p`,null,[s(`iss 的注释由 `),f(`code`,null,`;`),s(` 开头，`),f(`code`,null,`[Code]`),s(` 部分的注释另有两种方式：`)],-1),d[51]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Setup]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; AppName 指定应用程序的名称，这是一条注释`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`My Program`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Code]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`// 单行注释`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`(* 多行注释 *)`)])])],-1),d[52]||=f(`p`,null,[s(`支持类似 C 语言的 `),f(`code`,null,`#include`),s(` 指令，它可以将另一个文件中的内容插入到脚本中指令所在的位置。`)],-1),d[53]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`#`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#C792EA`,"--shiki-dark-font-style":`italic`}},`include`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},` "`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`filename.txt`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`)])])],-1),d[54]||=f(`p`,null,[s(`如果文件名不是绝对路径，编译器将在 iss 文件所在目录中查找。文件名可以以 `),f(`code`,null,`compiler:`),s(` 为前缀，在这种情况下，它会在编译器目录中查找该文件。`)],-1),d[55]||=f(`blockquote`,null,[f(`p`,null,[f(`code`,null,`compiler:`),s(` 为前缀时，查找编译器目录，指的就是 Inno Setup 的安装目录。`)])],-1),d[56]||=f(`p`,null,[s(`支持 `),f(`code`,null,`#preproc`),s(` 指令，该指令指定是否使用内置预处理器（仅支持上述 #include 指令）或使用 Inno 预处理器 (ISPP)，后者支持更多的指令。`)],-1),d[57]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,null,`#preproc builtin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,null,`#preproc ispp`)])])],-1),d[58]||=f(`p`,null,`默认情况下，iss 脚本使用 ISPP（如果可用），而 .isl 文件使用内置（built-in）预处理器。`,-1),d[59]||=f(`h3`,{id:`%E5%A4%9A%E8%AF%AD%E8%A8%80`},[s(`多语言`),f(`a`,{name:`%E5%A4%9A%E8%AF%AD%E8%A8%80`,class:`headerlink`,href:`#%E5%A4%9A%E8%AF%AD%E8%A8%80`})],-1),d[60]||=f(`p`,null,[s(`Inno 官方自带一部分多语言，可以在 Inno 安装目录下的 `),f(`code`,null,`Languages`),s(` 文件夹中找到。`)],-1),f(`p`,null,[d[8]||=s(`对于官方未支持的多语言（比如中文），可以在 `,-1),a(c,{target:`_blank`,href:`https://jrsoftware.org/files/istrans/`},{default:o(()=>[...d[7]||=[s(`https://jrsoftware.org/files/istrans/`,-1)]]),_:1}),d[9]||=s(` 下载，下载之后保存到 Inno 的 `,-1),d[10]||=f(`code`,null,`Languages`,-1),d[11]||=s(` 文件夹中，命名为 `,-1),d[12]||=f(`code`,null,`ChineseSimplified.isl`,-1),d[13]||=s(`。`,-1)]),d[61]||=f(`blockquote`,null,[f(`p`,null,`注意：文件格式不能是 UTF-8，需要是 UTF-8 with BOM 或者是 GBK 编码（可能还有其他可行的编码，但没尝试过），否则会出现中文乱码。`)],-1),d[62]||=f(`p`,null,`针对最开始的脚本，添加中文支持，重新编译并运行：`,-1),d[63]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Setup]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`My Program`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppVersion`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`1.0.0`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`DefaultDirName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{userdesktop}\\hello`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`WizardStyle`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`modern`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; 新增 Languages Section，指定为中文`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Languages]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: chinesesimp`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; MessagesFile: "compiler:Languages\\ChineseSimplified.isl"`)])])],-1),d[64]||=f(`p`,null,[f(`img`,{alt:`02-hello-installer-chinese.png`,loading:`lazy`,title:`02-hello-installer-chinese.png`,class:`post-image`,src:`/assets/02-hello-installer-chinese-qY3-CEhS.png`,onerror:`this.onerror=null;this.src='/images/image-error.jpg';`})],-1),d[65]||=f(`h3`,{id:`%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89`},[s(`常量（Constants）`),f(`a`,{name:`%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89`,class:`headerlink`,href:`#%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89`})],-1),d[66]||=f(`p`,null,[s(`前文 `),f(`code`,null,`DefaultDirName="{userdesktop}\\hello"`),s(`、`),f(`code`,null,`Source: "MYPROG.EXE"; DestDir: "{app}"`),s(` 中的 `),f(`code`,null,`userdesktop`),s(` 和 `),f(`code`,null,`app`),s(` 都是常量，安装和卸载的过程中，常量会被替换为用户选择的值或系统配置中的值。`)],-1),d[67]||=f(`p`,null,[s(`比如，`),f(`code`,null,`{app}`),s(` 常量会被替换为应用程序的安装目录，`),f(`code`,null,`{userdesktop}`),s(` 常量会被替换为用户桌面的路径。`)],-1),d[68]||=f(`p`,null,`完整的常量列表可以参考官方文档的常量章节。`,-1),d[69]||=f(`h3`,{id:`%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89`},[s(`公共参数（Common Parameters）`),f(`a`,{name:`%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89`,class:`headerlink`,href:`#%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89`})],-1),d[70]||=f(`p`,null,[s(`公共参数是指能在所有 `),f(`code`,null,`Section`),s(` 中都能被使用的参数，共有三条：`)],-1),d[71]||=f(`ul`,null,[f(`li`,null,[f(`code`,null,`Languages`)]),f(`li`,null,[f(`code`,null,`MinVersion`)]),f(`li`,null,[f(`code`,null,`OnlyBelowVersion`)])],-1),d[72]||=f(`blockquote`,null,[f(`p`,null,`TODO 待完善`)],-1),d[73]||=f(`h3`,{id:`Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`},[s(`Components 和 Tasks 参数`),f(`a`,{name:`Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`,class:`headerlink`,href:`#Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0`})],-1),d[74]||=f(`p`,null,[s(`除了 `),f(`code`,null,`[Types]`),s(`、`),f(`code`,null,`[Components]`),s(` 和 `),f(`code`,null,`[Tasks]`),s(`，其他 `),f(`code`,null,`Section`),s(` 都支持 `),f(`code`,null,`Components`),s(` 和 `),f(`code`,null,`Tasks`),s(` 两个可选参数。`)],-1),d[75]||=f(`h4`,{id:`Components%20%E5%8F%82%E6%95%B0`},[s(`Components 参数`),f(`a`,{name:`Components%20%E5%8F%82%E6%95%B0`,class:`headerlink`,href:`#Components%20%E5%8F%82%E6%95%B0`})],-1),d[76]||=f(`p`,null,`一个由空格分隔的组件名称列表，告诉安装程序该条目属于哪些组件。如果最终用户从此列表中选择了一个组件，则会处理该条目（例如：安装文件）。`,-1),d[77]||=f(`p`,null,[s(`没有 `),f(`code`,null,`Components`),s(` 参数的条目始终会被处理，除非有其他参数（比如后文的 Check）指示不应该这样做。`)],-1),d[78]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Files]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.EXE`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; Components: main`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.CHM`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; Components: help`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`README.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"`)])])],-1),d[79]||=f(`h4`,{id:`Tasks%20%E5%8F%82%E6%95%B0`},[s(`Tasks 参数`),f(`a`,{name:`Tasks%20%E5%8F%82%E6%95%B0`,class:`headerlink`,href:`#Tasks%20%E5%8F%82%E6%95%B0`})],-1),d[80]||=f(`p`,null,`一个以空格分隔的任务名称列表，告诉安装程序该条目属于哪个任务。如果最终用户从此列表中选择了一个任务，则会处理该条目（例如：安装文件）。`,-1),d[81]||=f(`p`,null,[s(`没有 `),f(`code`,null,`Tasks`),s(` 参数的条目始终会被处理，除非其他参数说明不应该这样做。`)],-1),d[82]||=f(`blockquote`,null,[f(`p`,null,[s(`请注意，在“选择开始菜单文件夹”向导页面上的“不创建开始菜单文件夹”复选框不影响具有 Tasks 参数的 `),f(`code`,null,`[Icons]`),s(` 条目，因为它们有自己的复选框。`)])],-1),d[83]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Icons]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{group}\\My Program`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Filename: "{app}\\MyProg.exe"; Components: main; Tasks: startmenu`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{group}\\My Program Help`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Filename: "{app}\\MyProg.chm"; Components: help; Tasks: startmenu`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{commondesktop}\\My Program`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Filename: "{app}\\MyProg.exe"; Components: main; Tasks: desktopicon`)])])],-1),d[84]||=f(`p`,null,[s(`除了空格分隔的列表，还可以将布尔表达式用作组件和任务参数。支持的运算符包括 `),f(`code`,null,`not`),s(`、`),f(`code`,null,`and`),s(` 和 `),f(`code`,null,`or`),s(`。`)],-1),d[85]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Components]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: a`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: b`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: b`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Tasks]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: p`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a or b; Components: a or b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: q`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a and b; Components: a and b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: r`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: not a or b; Components: not a or b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: s`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: not (a or b); Components: not (a or b)`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: t`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a or b - old style; Components: a b`)])])],-1),d[86]||=f(`h4`,{id:`%E5%B0%9D%E8%AF%95`},[s(`尝试`),f(`a`,{name:`%E5%B0%9D%E8%AF%95`,class:`headerlink`,href:`#%E5%B0%9D%E8%AF%95`})],-1),d[87]||=f(`p`,null,`上面都是摘自官方的解释，但到底是什么表现呢？`,-1),d[88]||=f(`p`,null,[s(`在脚本中新增 `),f(`code`,null,`Components`),s(` 和 `),f(`code`,null,`Tasks`),s(` 的相关内容，重新编译并运行：`)],-1),d[89]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Setup]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`My Program`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`AppVersion`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`1.0.0`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`DefaultDirName`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{userdesktop}\\hello`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`WizardStyle`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#D6DEEB`}},`=`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`modern`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Languages]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: chinesesimp`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; MessagesFile: "compiler:Languages\\ChineseSimplified.isl"`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Components]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: a`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: b`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: b`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Tasks]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: p`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a or b; Components: a or b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: q`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a and b; Components: a and b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: r`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: not a or b; Components: not a or b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: s`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: not (a or b); Components: not (a or b)`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: t`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: a or b - old style; Components: a b`)])])],-1),d[90]||=f(`ul`,null,[f(`li`,null,[f(`p`,null,[f(`img`,{alt:`03-hello-components-tasks.png`,loading:`lazy`,title:`03-hello-components-tasks.png`,class:`post-image`,src:`/assets/03-hello-components-tasks-B4mnTxeo.png`,onerror:`this.onerror=null;this.src='/images/image-error.jpg';`})])]),f(`li`,null,[f(`p`,null,[f(`img`,{alt:`04-hello-components-tasks-2.png`,loading:`lazy`,title:`04-hello-components-tasks-2.png`,class:`post-image`,src:`/assets/04-hello-components-tasks-2-7UpHA3XJ.png`,onerror:`this.onerror=null;this.src='/images/image-error.jpg';`})])]),f(`li`,null,[f(`p`,null,[f(`img`,{alt:`05-hello-components-tasks-3.png`,loading:`lazy`,title:`05-hello-components-tasks-3.png`,class:`post-image`,src:`/assets/05-hello-components-tasks-3-CRKO5Z_X.png`,onerror:`this.onerror=null;this.src='/images/image-error.jpg';`})])]),f(`li`,null,[f(`p`,null,[f(`code`,null,`[Components]`),s(`、`),f(`code`,null,`[Tasks]`),s(` 定义了组件和任务（选项）`)])]),f(`li`,null,[f(`p`,null,[f(`code`,null,`Components`),s(`、`),f(`code`,null,`Tasks`),s(` 参数就是根据条件（用户实际的选择组件或任务）来控制条目是否被处理`)])])],-1),d[91]||=f(`h2`,{id:`Sections%20%E5%AD%A6%E4%B9%A0`},[s(`Sections 学习`),f(`a`,{name:`Sections%20%E5%AD%A6%E4%B9%A0`,class:`headerlink`,href:`#Sections%20%E5%AD%A6%E4%B9%A0`})],-1),d[92]||=f(`h3`,{id:`%5BSetup%5D`},[s(`[Setup]`),f(`a`,{name:`%5BSetup%5D`,class:`headerlink`,href:`#%5BSetup%5D`})],-1),f(`p`,null,[d[15]||=s(`文档：`,-1),a(c,{target:`_blank`,href:`https://jrsoftware.org/ishelp/topic_setupsection.htm`},{default:o(()=>[...d[14]||=[s(`https://jrsoftware.org/ishelp/topic_setupsection.htm`,-1)]]),_:1})]),d[93]||=f(`p`,null,[f(`code`,null,`[Setup]`),s(` 包含安装程序和卸载程序使用的全局设置，是必须的。同时 `),f(`code`,null,`[Setup]`),s(` 下的 `),f(`code`,null,`AppName`),s(`、`),f(`code`,null,`AppVersion`),s(` 和 `),f(`code`,null,`DefaultDirName`),s(` 指令也是必填的。`)],-1),d[94]||=f(`p`,null,[f(`code`,null,`[Setup]`),s(` 包含多达 150+ 的指令，这里只挑几个过一过，实际则用到的时候再对照文档去看了。`)],-1),d[95]||=f(`p`,null,`指令大体分为三类：`,-1),d[96]||=f(`ul`,null,[f(`li`,null,[s(`编译相关（Compiler-related），可以理解为会影响编译行为的指令，如：`),f(`ul`,null,[f(`li`,null,[s(`Output：可以设置为 `),f(`code`,null,`yes`),s(` 或 `),f(`code`,null,`no`),s(`，默认为 `),f(`code`,null,`yes`),s(`，如果设置为 `),f(`code`,null,`no`),s(`，编译器将仅检查脚本中的错误并跳过创建安装文件`)]),f(`li`,null,[s(`OutputDir：指定输出目录，默认为 `),f(`code`,null,`Output`),s(`，可以设置为绝对路径或相对路径`)])])]),f(`li`,null,[s(`安装相关（Installer-related），影响安装/卸载程序的操作，如：`),f(`ul`,null,[f(`li`,null,[s(`AppName：该指令是必须，指定正在安装的应用程序名称。`),f(`strong`,null,`不要包括版本号，因为这由 AppVersion 和/或 AppVerName 指令定义`),s(`。AppName 会显示在窗口标题、向导页面和对话框中`)]),f(`li`,null,`AppVerName：该指令包含应用的名称和版本号，默认由 AppName 与 AppVersion 拼接而成，如果未设置 AppVersion 则该指令是必须的`)])]),f(`li`,null,[s(`和修饰类（Cosmetic），只影响安装程序的外观，如：`),f(`ul`,null,[f(`li`,null,[s(`SetupIconFile：指定安装/卸载程序的图标，编译器会在源目录中查找图标文件，除非是绝对路径或以 `),f(`code`,null,`compiler:`),s(` 开头的路径`)])])])],-1),d[97]||=f(`h3`,{id:`%5BTypes%5D`},[s(`[Types]`),f(`a`,{name:`%5BTypes%5D`,class:`headerlink`,href:`#%5BTypes%5D`})],-1),d[98]||=f(`p`,null,[s(`需要与 `),f(`code`,null,`[Components]`),s(` 配合使用，相当于预定义一组集合，方便用户选择组件：`)],-1),d[99]||=f(`p`,null,[s(`唯一 Flags 参数的值是 `),f(`code`,null,`iscustom`),s(`，表示该类型是自定义类型，如果不定义自定义类型，则只允许用户选择预定义的类型，并且无法再手动选择/取消选择组件。`)],-1),d[100]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Types]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`a`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "Full installation"`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`b`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "Compact installation"`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`c`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "Custom installation"; Flags: iscustom`)])])],-1),d[101]||=f(`h3`,{id:`%5BComponents%5D`},[s(`[Components]`),f(`a`,{name:`%5BComponents%5D`,class:`headerlink`,href:`#%5BComponents%5D`})],-1),d[102]||=f(`p`,null,[s(`前文已有介绍，这里只说明与 `),f(`code`,null,`[Types]`),s(` 配合的使用：`)],-1),d[103]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Components]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`c1`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "c1"; Types: a b c; Flags: fixed`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`c2`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "c2"; Types: a b`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`c3`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "c3"; Types: a`)])])],-1),d[104]||=f(`p`,null,[s(`因为定义了 `),f(`code`,null,`[Types]`),s(`，组件选择时会有三个选项，分别是 `),f(`code`,null,`Full installation`),s(`、`),f(`code`,null,`Compact installation`),s(` 和 `),f(`code`,null,`Custom installation`),s(`：`)],-1),d[105]||=f(`ul`,null,[f(`li`,null,[s(`选择 `),f(`code`,null,`Full installation`),s(` 会自动勾上 `),f(`code`,null,`c1`),s(`、`),f(`code`,null,`c2`),s(` 和 `),f(`code`,null,`c3`)]),f(`li`,null,[s(`选择 `),f(`code`,null,`Compact installation`),s(` 会自动勾上 `),f(`code`,null,`c1`),s(` 和 `),f(`code`,null,`c2`)]),f(`li`,null,[s(`若用户选择 `),f(`code`,null,`Custom installation`),s(`，则可以手动勾选 `),f(`code`,null,`c2`),s(` 和 `),f(`code`,null,`c3`)]),f(`li`,null,[f(`code`,null,`c1`),s(` 指定了 fixed，因此用户无法手动修改该选项`)])],-1),d[106]||=f(`h3`,{id:`%5BDirs%5D`},[s(`[Dirs]`),f(`a`,{name:`%5BDirs%5D`,class:`headerlink`,href:`#%5BDirs%5D`})],-1),d[107]||=f(`p`,null,[f(`code`,null,`[Dirs]`),s(` 定义了除用户选择的应用程序目录（自动创建）之外，安装程序需要创建的其他目录。在主应用程序目录下创建子目录是该 Section 常见的使用方式。`)],-1),d[108]||=f(`p`,null,`请注意，在使用 [Files] 部分安装文件时，不必显式地创建目录，因此该 Section 主要用于创建空目录。`,-1),d[109]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Dirs]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{app}\\data`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{app}\\bin`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`)])])],-1),d[110]||=f(`h3`,{id:`%5BFiles%5D`},[s(`[Files]`),f(`a`,{name:`%5BFiles%5D`,class:`headerlink`,href:`#%5BFiles%5D`})],-1),d[111]||=f(`p`,null,`该 Section 定义了安装程序需要安装的文件。换句话说，就是将定义的 Source 文件打包到安装程序中，安装的时候根据配置分别解压到特定目录。`,-1),d[112]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Files]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`README.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; Flags: isreadme`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; 支持通配符`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`subdir\\*`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}\\subdir"; Flags: isreadme`)])])],-1),d[113]||=f(`h3`,{id:`%5BIcons%5D`},[s(`[Icons]`),f(`a`,{name:`%5BIcons%5D`,class:`headerlink`,href:`#%5BIcons%5D`})],-1),d[114]||=f(`p`,null,`该 Section 定义了安装程序如何在开始菜单或其他位置（如桌面）创建快捷方式。`,-1),d[115]||=f(`blockquote`,null,[f(`p`,null,[s(`myapp.exe 是最终的可执行程序，也可以使用 Inno 自带的 demo 程序：`),f(`code`,null,`Inno 安装目录\\Examples\\MyProg.exe`),s(`。`)])],-1),d[116]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Icons]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; 创建桌面快捷方式`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Name: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{group}\\My Program`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Filename: "{app}\\myapp.exe"; WorkingDir: "{app}"`)])])],-1),d[117]||=f(`h3`,{id:`%5BRegistry%5D`},[s(`[Registry]`),f(`a`,{name:`%5BRegistry%5D`,class:`headerlink`,href:`#%5BRegistry%5D`})],-1),d[118]||=f(`p`,null,`该 Section 定义了安装程序如何在注册表中创建、修改或删除键/值。`,-1),d[119]||=f(`blockquote`,null,[f(`p`,null,`默认情况下，安装程序创建的注册表键和值在卸载时不会被删除。如果希望卸载程序的同时删除键或值，则 Flags 中须至少包含 uninsdelete、uninsdeletekeyifempty、uninsdeletevalue 中的一个。`)],-1),d[120]||=f(`p`,null,[s(`下面是注册伪协议的例子，可通过在浏览器中输入 `),f(`code`,null,`myapp://`),s(` 来打开应用程序：`)],-1),d[121]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Registry]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Root: HKCR`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; SubKey: Myapp; ValueData: "MyappProtocol"; ValueType: string; Flags: createvalueifdoesntexist uninsdeletekey noerror;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Root: HKCR`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; SubKey: Myapp; ValueName: "URL Protocol"; ValueData: "{app}\\myapp.exe"; ValueType: string; Flags: createvalueifdoesntexist uninsdeletekey noerror;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Root: HKCR`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; SubKey: Myapp\\DefaultIcon; ValueData: "{app}\\myapp.exe"; ValueType: string; Flags: createvalueifdoesntexist uninsdeletekey noerror;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Root: HKCR`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; SubKey: Myapp\\shell\\open\\command; ValueData: "{app}\\myapp.exe --open-url=""%1"""; Flags: uninsdeletekey noerror; ValueType: string;`)])])],-1),d[122]||=f(`p`,null,`Flags 说明：`,-1),d[123]||=f(`ul`,null,[f(`li`,null,`createvalueifdoesntexist：注册表中不存在时才创建相应条目`),f(`li`,null,`uninsdeletekey：卸载时删除该键`),f(`li`,null,`noerror：不展示注册表键或值设置失败的信息`)],-1),d[124]||=f(`blockquote`,null,[f(`p`,null,[s(`官方不建议直接操作注册表 HKCR，而是使用 `),f(`code`,null,`HKA\\Software\\Classes`),s(` 作为替代。理由暂时不清楚，同时注册表的相关知识也只了解了零星半点，边学边搞吧。`)])],-1),d[125]||=f(`h3`,{id:`%5BRun%5D%20%26%20%5BUninstallRun%5D`},[s(`[Run] & [UninstallRun]`),f(`a`,{name:`%5BRun%5D%20%26%20%5BUninstallRun%5D`,class:`headerlink`,href:`#%5BRun%5D%20%26%20%5BUninstallRun%5D`})],-1),d[126]||=f(`ul`,null,[f(`li`,null,[f(`code`,null,`[Run]`),s(` 定义了在安装完成之后需要执行的程序`)]),f(`li`,null,[f(`code`,null,`[UninstallRun]`),s(` 定义了在卸载第一步需要执行的程序`)])],-1),d[127]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Run]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; 安装完成最后一步，关闭安装向导后是否允许 myapp.exe`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Filename: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{app}\\myapp.exe`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Description: "Run myapp"; Flags: nowait postinstall skipifsilent`)])])],-1),d[128]||=f(`h2`,{id:`Pascal%20%E8%84%9A%E6%9C%AC`},[s(`Pascal 脚本`),f(`a`,{name:`Pascal%20%E8%84%9A%E6%9C%AC`,class:`headerlink`,href:`#Pascal%20%E8%84%9A%E6%9C%AC`})],-1),f(`p`,null,[d[17]||=s(`除了上面看起来像是”配置式”的内容，Inno 还支持添加脚本（语法为 `,-1),a(c,{target:`_blank`,href:`https://zh.wikipedia.org/zh-sg/Object_Pascal`},{default:o(()=>[...d[16]||=[s(`Object Pascal`,-1)]]),_:1}),d[18]||=s(`）以实现自定义的逻辑，具有更多的创造性，比如：`,-1)]),d[129]||=f(`ul`,null,[f(`li`,null,`支持在自定义条件下中止安装或卸载`),f(`li`,null,`支持在运行时添加自定义引导页面`),f(`li`,null,`支持在安装之前、期间或之后通过 Pascal 脚本来提取、调用 DLL 或其他文件`),f(`li`,null,`支持编写常量，这些常量可以执行普通常量、从注册表读取、从 ini 读取和从命令行读取等操作`),f(`li`,null,[s(`支持在运行时根据自定义条件删除 `),f(`code`,null,`[Types]`),s(`、`),f(`code`,null,`[Components]`),s(` 或 `),f(`code`,null,`[Tasks]`)]),f(`li`,null,[s(`基于自定义条件，支持有条件地安装 `),f(`code`,null,`[Files]`),s(`、`),f(`code`,null,`[Registry]`),s(`、`),f(`code`,null,`[Run]`),s(` 等条目`)]),f(`li`,null,`提供了大量辅助函数，可通过 Pascal 脚本完成 Inno Setup 所能做到的几乎所有事情`)],-1),d[130]||=f(`blockquote`,null,[f(`p`,null,[s(`注意：从这里开始，若无特殊说明，脚本特指 `),f(`code`,null,`[Code]`),s(` 中的 Pascal 脚本，脚本仅在运行时执行，因此不能干涉 iss 本身的编译`)])],-1),d[131]||=f(`h3`,{id:`%5BCode%5D`},[s(`[Code]`),f(`a`,{name:`%5BCode%5D`,class:`headerlink`,href:`#%5BCode%5D`})],-1),d[132]||=f(`p`,null,`所有脚本内容的定义需要位于该 Section。`,-1),d[133]||=f(`h4`,{id:`%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0`},[s(`事件函数`),f(`a`,{name:`%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0`,class:`headerlink`,href:`#%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0`})],-1),d[134]||=f(`p`,null,[s(`可以在 `),f(`code`,null,`[Code]`),s(` 定义事件回调函数，在适当的时机会被执行，例：`)],-1),d[135]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Code]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`function`),f(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#82AAFF`,"--shiki-dark-font-style":`italic`}},` InitializeSetup`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`(): `),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#C792EA`,"--shiki-dark-font-style":`italic`}},`Boolean`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`  begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`    if`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` (Msgbox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`是否继续安装`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbConfirmation, MB_YESNO) = IDYES) `),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`then`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`      Result`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` := `),f(`span`,{style:{"--shiki-light":`#1976D2`,"--shiki-dark":`#82AAFF`}},`True`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`    else`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`      Result`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` := `),f(`span`,{style:{"--shiki-light":`#1976D2`,"--shiki-dark":`#82AAFF`}},`False`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`    end`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`  end`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`.`)])])],-1),d[136]||=f(`p`,null,`定义事件函数 InitializeSetup，该函数会在安装初始化的时候被调用，返回值为 Boolean，如果返回 True 则继续安装，否则中止安装。上面的例子中，在初始化过程中加入了“弹出确认框”的逻辑，询问用户是否继续安装。`,-1),d[137]||=f(`p`,null,`通常情况下，同一个事件只能定义一个回调函数的实现。但使用事件属性（Event Attributes）可以在脚本中拥有同一事件函数的多个实现。这在包含了实现事件函数的外部脚本中特别有用，以避免与主要脚本发生冲突。`,-1),d[138]||=f(`p`,null,`以下是一个示例脚本，其中包含三个 InitializeWizard 事件函数的实现，每次触发会弹一个提示框，一共会弹三次：`,-1),d[139]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`procedure`),f(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#82AAFF`,"--shiki-dark-font-style":`italic`}},` InitializeWizard`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  SuppressibleMsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`InitializeWizard called 1`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK, IDOK);`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`end`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`<`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`event`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`InitializeWizard`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`)>`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`procedure`),f(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#82AAFF`,"--shiki-dark-font-style":`italic`}},` InitializeWizard2`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  SuppressibleMsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`InitializeWizard called 2`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK, IDOK);`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`end`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`<`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`event`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`InitializeWizard`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`)>`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`procedure`),f(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#82AAFF`,"--shiki-dark-font-style":`italic`}},` InitializeWizard3`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  SuppressibleMsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`InitializeWizard called 3`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK, IDOK);`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`end`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)])])],-1),d[140]||=f(`p`,null,[s(`注意到，第二个定义需要使用了 `),f(`code`,null,`procedure`),s(` 关键字，而不是 `),f(`code`,null,`function`),s(`，两者都是子程序，但又有区别，简单来说：`)],-1),d[141]||=f(`ul`,null,[f(`li`,null,[f(`code`,null,`procedure`),s(` 表示过程，不会直接返回值`)]),f(`li`,null,[f(`code`,null,`function`),s(` 是函数，返回单个值`)])],-1),d[142]||=f(`h4`,{id:`%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F`},[s(`脚本常量`),f(`a`,{name:`%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F`,class:`headerlink`,href:`#%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F`})],-1),d[143]||=f(`p`,null,`这个例子演示了如何在脚本中使用常量，同时脚本中定义的函数也可以在其他地方使用，比如：`,-1),d[144]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Setup]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`DefaultDirName="`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`{code:MyConst}`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`"`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Code]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`function`),f(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#82AAFF`,"--shiki-dark-font-style":`italic`}},` MyConst`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`(Param: `),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#C792EA`,"--shiki-dark-font-style":`italic`}},`String`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`): `),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#C792EA`,"--shiki-dark-font-style":`italic`}},`String`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`  Result`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` := ExpandConstant(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{userdesktop}`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`) + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`/appdest`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-dark":`#C792EA`}},`end`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`;`)])])],-1),d[145]||=f(`p`,null,[s(`注意，`),f(`code`,null,`MyConst`),s(` 函数必须要定义一个参数。`)],-1),f(`p`,null,[d[20]||=s(`同时，Inno `,-1),a(c,{target:`_blank`,href:`https://jrsoftware.org/ishelp/topic_scriptfunctions.htm`},{default:o(()=>[...d[19]||=[s(`内置了许多函数`,-1)]]),_:1}),d[21]||=s(`可以被直接使用：`,-1)]),d[146]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[INI]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; GetShortName`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`FileName: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{app}\\MyIni.ini`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; Section: "MySettings"; Key: "ShortApp"; String: "{code:GetShortName|{app}}"`)])])],-1),d[147]||=f(`h4`,{id:`Check%20%E5%8F%82%E6%95%B0`},[s(`Check 参数`),f(`a`,{name:`Check%20%E5%8F%82%E6%95%B0`,class:`headerlink`,href:`#Check%20%E5%8F%82%E6%95%B0`})],-1),d[148]||=f(`p`,null,[s(`所有参数形式的 Section 都支持 `),f(`code`,null,`Check`),s(` 参数，可以在程序过程中根据条件决定是否生效，比如：`)],-1),d[149]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Files]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.EXE`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; Check: MyProgCheck`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`A\\MYFILE.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; Check: MyDirCheck(ExpandConstant('{app}\\A'))`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`B\\MYFILE.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; Check: DirExists(ExpandConstant('{app}\\B'))`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Code]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`var`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  MyProgChecked: Boolean`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  MyProgCheckResult: Boolean`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`function MyProgCheck(): Boolean`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  if not MyProgChecked then begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`    MyProgCheckResult := MsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`Do you want to install MyProg.exe to `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + ExtractFilePath(CurrentFileName) + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`?`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbConfirmation, MB_YESNO) = idYes`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`    MyProgChecked := True`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  Result := MyProgCheckResult`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`function MyDirCheck(DirName: String): Boolean`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  Result := DirExists(DirName)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)])])],-1),d[150]||=f(`p`,null,`注意：`,-1),d[151]||=f(`ul`,null,[f(`li`,null,[f(`code`,null,`[Files]`),s(` 中的条目如果包含通配符，`),f(`code`,null,`Check`),s(` 会对每一个文件都执行一次，而不是整个条目`)])],-1),d[152]||=f(`h4`,{id:`BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0`},[s(`BeforeInstall & AfterInstall 参数`),f(`a`,{name:`BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0`,class:`headerlink`,href:`#BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0`})],-1),d[153]||=f(`p`,null,[s(`所有参数形式的 Section 也都支持 `),f(`code`,null,`BeforeInstall`),s(` 和 `),f(`code`,null,`AfterInstall`),s(`，分别是在条目安装之前、之后执行：`)],-1),d[154]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Files]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.EXE`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; BeforeInstall: MyBeforeInstall`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`A\\MYFILE.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; BeforeInstall: MyBeforeInstall2('{app}\\A\\MYFILE.TXT')`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`B\\MYFILE.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; BeforeInstall: MyBeforeInstall2('{app}\\B\\MYFILE.TXT')`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.CHM`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; BeforeInstall: Log('Before MYPROG.CHM Install')`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.EXE`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; AfterInstall: MyAfterInstall`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`A\\MYFILE.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; AfterInstall: MyAfterInstall2('{app}\\A\\MYFILE.TXT')`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`B\\MYFILE.TXT`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; AfterInstall: MyAfterInstall2('{app}\\B\\MYFILE.TXT')`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`Source: `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`MYPROG.CHM`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`"`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`; DestDir: "{app}"; AfterInstall: Log('After MYPROG.CHM Install')`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Code]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`procedure MyBeforeInstall()`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  MsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`About to install MyProg.exe as `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + CurrentFileName + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`.`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`procedure MyBeforeInstall2(FileName: String)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  MsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`About to install `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + FileName + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},` as `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + CurrentFileName + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`.`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`procedure MyAfterInstall()`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  MsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`Just installed MyProg.exe as `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + CurrentFileName + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`.`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`}),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`procedure MyAfterInstall2(FileName: String)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  MsgBox(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`Just installed `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + FileName + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},` as `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},` + CurrentFileName + `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`.`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, mbInformation, MB_OK)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)])])],-1),d[155]||=f(`p`,null,`注意：`,-1),d[156]||=f(`ul`,null,[f(`li`,null,`所有 BeforeInstall 和 AfterInstall 的函数不应该拥有返回值`),f(`li`,null,`如果安装程序已确定不应处理该条目，则不会调用 BeforeInstall 或 AfterInstall 函数`),f(`li`,null,[f(`code`,null,`[Files]`),s(` 中的条目如果包含通配符，BeforeInstall 和 AfterInstall 会对每一个文件都执行一次，而不是整个条目`)])],-1),d[157]||=f(`h4`,{id:`%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86`},[s(`调用 DLLs 和 .Net 程序集`),f(`a`,{name:`%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86`,class:`headerlink`,href:`#%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86`})],-1),d[158]||=f(`p`,null,`脚本可以调用外部 DLL 中的函数，这包括标准 Windows DLL 中的标准 Win32 API 函数和自定义制作的 DLL 中的自定义函数。此外，还可以调用 .NET 程序集。`,-1),d[159]||=f(`blockquote`,null,[f(`p`,null,`先知道有这么个能力吧，实际还没用到过`)],-1),d[160]||=f(`h4`,{id:`%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects`},[s(`使用 COM Automation Objects`),f(`a`,{name:`%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects`,class:`headerlink`,href:`#%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects`})],-1),d[161]||=f(`blockquote`,null,[f(`p`,null,`这些概念属实没接触过，感觉上也是能直接调用一些系统或系统库的能力`)],-1),d[162]||=f(`p`,null,`脚本可以通过 COM Automation 对象支持来访问 COM（也称为 OLE 或 ActiveX）方法和属性。这使得可以访问标准 Windows COM 服务器、自定义 COM 服务器、Visual Basic ActiveX DLL 和 .NET 程序集，可以通过 COM Interop 进行交互。`,-1),d[163]||=f(`ul`,null,[f(`li`,null,[s(`IDispatch based COM`),f(`ul`,null,[f(`li`,null,`可通过 CreateOleObject 和 GetActiveOleObject 来初始化基于 IDispatch 的 COM`)])]),f(`li`,null,[s(`IUnknown based COM`),f(`ul`,null,[f(`li`,null,`如果对象没有实现 IDispatch 接口，可以使用 CreateComObject 来初始化基于 IUnknown 的 COM`)])])],-1),d[164]||=f(`p`,null,`如下是一个通过 WinHttpRequest 发送 HTTP 请求的例子：`,-1),d[165]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`[Code]`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`procedure SendHttp`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  begin`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`    WinHttpReq := CreateOleObject(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`WinHttp.WinHttpRequest.5.1`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`    WinHttpReq.Open(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`POST`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`https://api.exapmle.com`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, false)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`    WinHttpReq.SetRequestHeader(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`Content-Type`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`, `),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`application/json`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`    WinHttpReq.Send(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#ECC48D`}},`{"key":"value"}`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-dark":`#D9F5DD`}},`'`),f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`)`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)]),s(`
`),f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#24292EFF`,"--shiki-dark":`#D6DEEB`}},`  end`),f(`span`,{style:{"--shiki-light":`#C2C3C5`,"--shiki-light-font-style":`inherit`,"--shiki-dark":`#637777`,"--shiki-dark-font-style":`italic`}},`;`)])])],-1),d[166]||=f(`h2`,{id:`%E7%BB%93%E8%AF%AD`},[s(`结语`),f(`a`,{name:`%E7%BB%93%E8%AF%AD`,class:`headerlink`,href:`#%E7%BB%93%E8%AF%AD`})],-1),d[167]||=f(`p`,null,`根据文档说明，每个 Section 逐步试验下来，基本上浅浅了解了下 Inno 的各个方面。Inno 本身不难，就是各种指令、参数、Flags 以及内置函数比较多，想要全盘熟悉、用得顺手也不容易。对于 Pascal 语言，虽然没接触过，但有编程经验学点简单的写法很轻松。`,-1),d[168]||=f(`p`,null,[s(`个人而言，最棘手的还是 Windows 平台开发相关的内容，比如注册表的修改，为什么改这个键，为什么设置这个值，这需要查询另外的资料；比如 `),f(`code`,null,`[Code]`),s(` 脚本中，可以调用哪些能力，这也需要额外的知识和经验，这些都是我目前未接触的领域。`)],-1),d[169]||=f(`p`,null,`总之，Inno 不难，以后随着实际使用再慢慢深入吧。`,-1),d[170]||=f(`hr`,null,null,-1),d[171]||=f(`p`,null,`参考资料：`,-1),f(`ul`,null,[f(`li`,null,[d[23]||=s(`官方文档：`,-1),a(c,{target:`_blank`,href:`https://jrsoftware.org/ishelp/`},{default:o(()=>[...d[22]||=[s(`https://jrsoftware.org/ishelp/`,-1)]]),_:1})]),f(`li`,null,[d[25]||=s(`Object Pascal：`,-1),a(c,{target:`_blank`,href:`https://zh.wikipedia.org/zh-sg/Object_Pascal`},{default:o(()=>[...d[24]||=[s(`https://zh.wikipedia.org/zh-sg/Object_Pascal`,-1)]]),_:1})]),f(`li`,null,[d[27]||=s(`Pascal 教程：`,-1),a(c,{target:`_blank`,href:`https://www.jc2182.com/pascal/pascal-jiaocheng.html`},{default:o(()=>[...d[26]||=[s(`https://www.jc2182.com/pascal/pascal-jiaocheng.html`,-1)]]),_:1})])])]),_:1})]),e(x).length?(n(),u(`aside`,{key:0,class:t([e(S).showIndexSidebar?`bg-[#00000080]`:`pointer-events-none`,`fixed z-20 top-0 w-full h-full left-0 overscroll-contain transition-300`,`lg:pointer-events-auto`,`lg:absolute lg:w-auto lg:bg-transparent lg:left-[calc(100%+clamp(6px,17.1875vw-176px,50px))]`]),onClick:d[0]||=(...e)=>l.hideIndexSidebar&&l.hideIndexSidebar(...e)},[f(`nav`,{class:t([`overflow-y-auto text-foreground overscroll-contain bg-background`,`w-74 max-w-4/5 h-full py-8 px-6 rounded-tl-xl rounded-bl-xl`,`absolute top-0 transition-300 right-0`,e(S).showIndexSidebar?`translate-x-0`:`translate-x-full`,`lg:p-0 lg:max-w-44 xl:max-w-50 lg:h-auto lg:max-h-[calc(100vh-130px)] lg:rounded-none`,`lg:sticky lg:top-10 lg:right-auto lg:translate-x-0 lg:bg-transparent lg:ml-0`])},[d[172]||=f(`h2`,{class:`mb-2 font-bold lg:hidden`},`TABLE OF CONTENTS`,-1),a(m,{toc:e(x)},null,8,[`toc`])],2)],2)):i(``,!0)]),d[173]||=f(`hr`,{class:`border-border mt-10`},null,-1),e(b).comments?(n(),u(`div`,y,[a(p)])):i(``,!0)],64))}}),[[`__scopeId`,`data-v-1dc8ddbb`]]);export{b as default};