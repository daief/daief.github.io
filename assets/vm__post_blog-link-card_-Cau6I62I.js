import{L as e,R as t,T as n,c as r,f as i,h as a,j as o,m as s,n as c,o as l,p as u,t as d,u as f}from"./app-DvX1Smg_.js";import"./isObject-STXFNBUz.js";import"./isSymbol-CUbBZ03s.js";import"./toNumber-CiYTsHHK.js";import"./now-BXsIGwzm.js";import{n as p,t as m}from"./toc-DNILfFl5.js";import{n as h,t as g}from"./meta-info-C-tMy3g2.js";import{t as _}from"./use-page-title-CHxbaOlI.js";import{t as v}from"./blog-link-card-BcQquwcx.js";var y={class:`relative`},b={key:0,class:`mt-10`},x=l(Object.assign({name:`Article`},{__name:`vm:_post_blog-link-card_`,setup(l){_({title:`在博客中添加卡片式链接`,description:``});let{meta:v,toc:x}={meta:{title:`在博客中添加卡片式链接`,date:`2021-08-21T14:27:25.000Z`,id:`blog-link-card`,categories:[`前端`],keywords:[`博客链接卡片`],description:null,tags:[`Blog`],sort:0,comments:!0,draft:!1},toc:[{id:`%E5%AE%9E%E7%8E%B0`,text:`实现`,level:2,children:[],parent:``},{id:`%E7%BB%93%E8%AF%AD`,text:`结语`,level:2,children:[],parent:``}]},{appState:S}=d();return(l,d)=>(n(),u(r,null,[f(`div`,y,[f(`article`,null,[f(`header`,null,[d[1]||=f(`h1`,{class:`text-foreground text-3xl font-bold mb-4`},` 在博客中添加卡片式链接 `,-1),a(g,{meta:e(v)},null,8,[`meta`])]),a(h,{class:`mt-6`},{default:o(()=>[d[6]||=f(`p`,null,`最近升级了的企业微信，发现发送链接信息的时候，企信会自动拉取链接的标题、描述和图片信息，并组合成卡片的形式进行展示，给人的感觉就很棒，既传递了更多的信息，又显得美观，就想着在博客里也加上这个功能。`,-1),f(`p`,null,[d[3]||=s(`效果是下面这样的，如果展示的还是链接，那可能是还没加载出来或者背后的服务挂了（白嫖不易）：`,-1),a(c,{"data-layout":`card`,target:`_blank`,href:`https://github.com`},{default:o(()=>[...d[2]||=[s(`Github`,-1)]]),_:1})]),d[7]||=f(`p`,null,`截图效果如下：`,-1),d[8]||=f(`p`,null,[f(`img`,{alt:`卡片截图`,loading:`lazy`,width:`390px`,title:`blog-link-card.png`,class:`post-image`,src:`/assets/blog-link-card-CHW4z9j8.png`,onerror:`this.onerror=null;this.src='/images/image-error.jpg';`})],-1),d[9]||=f(`a`,{id:`more`,href:`#more`,class:`block`},null,-1),d[10]||=f(`h2`,{id:`%E5%AE%9E%E7%8E%B0`},[s(`实现`),f(`a`,{name:`%E5%AE%9E%E7%8E%B0`,class:`headerlink`,href:`#%E5%AE%9E%E7%8E%B0`})],-1),d[11]||=f(`p`,null,`实现思路其实很简单，请求目标 url 的文本内容（HTML），接着在前端解析 HTML 标签内容，提取出标题、描述和图片，最后将超链接转换成卡片的样式。`,-1),d[12]||=f(`p`,null,`期间主要考虑的问题有两点：`,-1),d[13]||=f(`ul`,null,[f(`li`,null,`如何解决前端发起请求时的跨域问题`),f(`li`,null,`如何使用 markdown 语法来表达卡片链接，并且不要破坏 markdown 的语法（原本用 hexo 里面就会有一些特定方言，尽量避免，以后迁移也不会有什么问题）`)],-1),f(`p`,null,[d[5]||=s(`第一个问题没法以纯前端的方式去解决了，最直接同时最简单的方式就是搭建一个允许跨域的代理服务器，但上服务器是不可能上的，于是谷歌一搜，真有免费的跨域代理（又赚了一个亿），确认了下不会被墙，那么先用了再说：`,-1),a(c,{"data-layout":`card`,target:`_blank`,href:`https://allorigins.win/`},{default:o(()=>[...d[4]||=[s(`allOrigins`,-1)]]),_:1})]),d[14]||=f(`p`,null,`接着关于第二个问题，观察标准的 markdown 语法是支持书写 href、text 和 title，href 是功能性的，text 是直接会展示的，只能在 title 上做手脚，我的想法就是将 title 的定义改了，支持直接写 url query 键值对的方式，这样一来就能输入更多的配置项：`,-1),d[15]||=f(`pre`,{class:`shiki shiki-themes min-light night-owl`,style:{"--shiki-light":`#24292eff`,"--shiki-dark":`#d6deeb`,"--shiki-light-bg":`#ffffff`,"--shiki-dark-bg":`#011627`},tabindex:`0`},[f(`code`,null,[f(`span`,{class:`line`},[f(`span`,{style:{"--shiki-light":`#1976D2`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#D6DEEB`,"--shiki-dark-text-decoration":`inherit`}},`[`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#D6DEEB`,"--shiki-dark-text-decoration":`inherit`}},`Github`),f(`span`,{style:{"--shiki-light":`#1976D2`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#D6DEEB`,"--shiki-dark-text-decoration":`inherit`}},`]`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#7FDBCA`,"--shiki-dark-text-decoration":`inherit`}},`(`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#FF869A`,"--shiki-dark-text-decoration":`underline`}},`https://github.com`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#82B1FF`,"--shiki-dark-text-decoration":`inherit`}},` '`),f(`span`,{style:{"--shiki-light":`#2B5581`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#ECC48D`,"--shiki-dark-text-decoration":`inherit`}},`class=red&target=_blank&data-layout=card`),f(`span`,{style:{"--shiki-light":`#D32F2F`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#82B1FF`,"--shiki-dark-text-decoration":`inherit`}},`'`),f(`span`,{style:{"--shiki-light":`#22863A`,"--shiki-light-text-decoration":`underline`,"--shiki-dark":`#7FDBCA`,"--shiki-dark-text-decoration":`inherit`}},`)`)])])],-1),d[16]||=f(`p`,null,[s(`可以约定配置了 `),f(`code`,null,`data-layout=card`),s(` 的超链接就将其转换成卡片。`)],-1),d[17]||=f(`p`,null,`解法都有了就可以实现了，就是请求 HTML 文本解析内容，而内容提取的逻辑可以做得细节一点，比如可以定义三种信息的解析优先级：`,-1),d[18]||=f(`ul`,null,[f(`li`,null,`title：页面 title => meta 中的 og:title 字段 => markdown 中的 text`),f(`li`,null,`description：meta 中的 description 字段 => meta 中的 og:description 字段 => 原始 href`),f(`li`,null,`image：meta 中的 image 字段 => meta 中的 og:image 字段 => 页面中第一个 img 标签的 src => 网站 icon => 默认图片`)],-1),d[19]||=f(`p`,null,`最后可以再考虑展示时的优化，比如因为是前端逻辑，每次都会触发页面的请求，可以像图片一样做个懒加载，当超链接滚动到视口内再执行转换逻辑。`,-1),d[20]||=f(`h2`,{id:`%E7%BB%93%E8%AF%AD`},[s(`结语`),f(`a`,{name:`%E7%BB%93%E8%AF%AD`,class:`headerlink`,href:`#%E7%BB%93%E8%AF%AD`})],-1),d[21]||=f(`p`,null,`内容比较简单，但提升的体验还是不少的，开始愉快地使用起来吧。`,-1),d[22]||=f(`p`,null,`在这里要感谢各大厂商和大佬提供的免费服务，感谢他们让我以白嫖的姿态享受到了各种服务。`,-1)]),_:1})]),e(x).length?(n(),u(`aside`,{key:0,class:t([e(S).showIndexSidebar?`bg-[#00000080]`:`pointer-events-none`,`fixed z-20 top-0 w-full h-full left-0 overscroll-contain transition-300`,`lg:pointer-events-auto`,`lg:absolute lg:w-auto lg:bg-transparent lg:left-[calc(100%+clamp(6px,17.1875vw-176px,50px))]`]),onClick:d[0]||=(...e)=>l.hideIndexSidebar&&l.hideIndexSidebar(...e)},[f(`nav`,{class:t([`overflow-y-auto text-foreground overscroll-contain bg-background`,`w-74 max-w-4/5 h-full py-8 px-6 rounded-tl-xl rounded-bl-xl`,`absolute top-0 transition-300 right-0`,e(S).showIndexSidebar?`translate-x-0`:`translate-x-full`,`lg:p-0 lg:max-w-44 xl:max-w-50 lg:h-auto lg:max-h-[calc(100vh-130px)] lg:rounded-none`,`lg:sticky lg:top-10 lg:right-auto lg:translate-x-0 lg:bg-transparent lg:ml-0`])},[d[23]||=f(`h2`,{class:`mb-2 font-bold lg:hidden`},`TABLE OF CONTENTS`,-1),a(m,{toc:e(x)},null,8,[`toc`])],2)],2)):i(``,!0)]),d[24]||=f(`hr`,{class:`border-border mt-10`},null,-1),e(v).comments?(n(),u(`div`,b,[a(p)])):i(``,!0)],64))}}),[[`__scopeId`,`data-v-a618cbd9`]]);export{x as default};