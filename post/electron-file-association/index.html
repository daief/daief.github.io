<!DOCTYPE html><html ssthtmlattrs="" lang="en"><head>
    <title>Electron 实现文件关联 | Daief's Blog</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--ssr-head-partial-->
    <script>
      if (/MSIE \d|Trident.*rv:/.test(navigator.userAgent)) {
        // redirect IE to Edge
        // This browser is no longer supported
        window.location.href = 'microsoft-edge:' + window.location.href;
        alert('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
        throw new Error('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
      }
    </script>
    <script type="module" crossorigin="" src="/assets/app-DvX1Smg_.js"></script>
    <link rel="stylesheet" crossorigin="" href="/assets/app-lBf8QYnm.css">
  <link rel="modulepreload" crossorigin="" href="/assets/vm__post_electron-file-association_-CU3hL9Qg.js"><link rel="stylesheet" href="/assets/vm__post_electron-file-association_-QOjOZzfA.css"><link rel="modulepreload" crossorigin="" href="/assets/meta-info-C-tMy3g2.js"><link rel="modulepreload" crossorigin="" href="/assets/toc-DNILfFl5.js"><link rel="stylesheet" href="/assets/toc-m8VwwUnR.css"><meta name="description" content=""><meta property="og:title" content="Electron 实现文件关联 | Daief's Blog"><meta property="og:description" content=""><meta property="og:image" content="https://avatars.githubusercontent.com/u/19222089?v=4"><meta name="author" content="daief"></head>
  <body ssrbodyattrs="">
    <div class="page-bg-gradient pointer-events-none fixed start-0 top-0 z-[-1] h-screen w-full"></div>
    <div id="app" data-server-rendered="true"><!--[--><div class="flex flex-col min-h-screen transition-colors duration-300"><header data-v-c69b61b1=""><div id="nav-container" class="max-w-app mx-auto text-foreground sm:bg-transparent" data-v-c69b61b1=""><div id="top-nav-wrap" class="relative grid grid-cols-2 auto-rows-auto w-full items-center justify-between p-4 sm:py-6 sm:flex sm:grid-rows-1" data-v-c69b61b1=""><a href="/" class="py-1 text-xl leading-8 font-semibold whitespace-nowrap sm:my-auto sm:text-2xl sm:leading-none" data-v-c69b61b1=""><!--[-->Daief's Blog<!--]--></a><div class="flex-center justify-end space-x-4 sm:hidden" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button><a role="button" class="text-2xl p-1" data-v-c69b61b1=""><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-c69b61b1=""><path fill="currentColor" d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></a></div><nav id="nav-menu" class="col-start-1 col-end-3 w-full flex-col items-center static top-full left-0 right-0 z-10 mt-4 sm:mt-0 sm:ms-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0 sm:flex hidden" data-v-c69b61b1=""><ul id="menu-items" class="w-full place-content-center gap-2 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0" data-v-c69b61b1=""><!--[--><li class="col-span-2" data-v-c69b61b1=""><a href="/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1 nav-active" data-v-c69b61b1=""><!--[-->文章<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/tags/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->标签<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/about/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->关于<!--]--></a></li><!--]--><li class="col-span-1 hidden sm:block" data-v-c69b61b1=""><a class="flex justify-center items-center h-full px-4 py-3 sm:px-2 sm:py-1" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button></a></li></ul></nav></div></div><div class="mx-auto max-w-app px-4" data-v-c69b61b1=""><hr class="border-border" aria-hidden="true" data-v-c69b61b1=""></div></header><main class="flex-grow max-w-app mx-auto px-4 py-8 w-full text-foreground"><!--[--><div class="relative" data-v-de2a0df0=""><article data-v-de2a0df0=""><header data-v-de2a0df0=""><h1 class="text-foreground text-3xl font-bold mb-4" data-v-de2a0df0=""> Electron 实现文件关联 </h1><div class="flex items-center gap-x-3.5 gap-y-0.5 text-foreground opacity-80 flex-wrap" data-v-de2a0df0=""><!--[--><!--[--><div class="inline-flex items-center gap-x-0.5 whitespace-nowrap"><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="M7 11h2v2H7zm14-6v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2M5 7h14V5H5zm14 12V9H5v10zm-4-6v-2h2v2zm-4 0v-2h2v2zm-4 2h2v2H7zm8 2v-2h2v2zm-4 0v-2h2v2z"></path></svg><span>发表于：<time datetime="2023-05-04T11:45:57.000Z">2023/05/04</time></span></div><!--[--><a href="/tags/%E6%A1%8C%E9%9D%A2%E5%BC%80%E5%8F%91/1/" class="inline-flex items-center foreground-link"><svg class="iconify-svg block select-none mr-0.5 text-foreground" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="m5.41 21l.71-4h-4l.35-2h4l1.06-6h-4l.35-2h4l.71-4h2l-.71 4h6l.71-4h2l-.71 4h4l-.35 2h-4l-1.06 6h4l-.35 2h-4l-.71 4h-2l.71-4h-6l-.71 4zM9.53 9l-1.06 6h6l1.06-6z"></path></svg>桌面开发</a><a href="/tags/Electron/1/" class="inline-flex items-center foreground-link"><svg class="iconify-svg block select-none mr-0.5 text-foreground" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="m5.41 21l.71-4h-4l.35-2h4l1.06-6h-4l.35-2h4l.71-4h2l-.71 4h6l.71-4h2l-.71 4h4l-.35 2h-4l-1.06 6h4l-.35 2h-4l-.71 4h-2l.71-4h-6l-.71 4zM9.53 9l-1.06 6h6l1.06-6z"></path></svg>Electron</a><a href="/tags/Inno%20Setup/1/" class="inline-flex items-center foreground-link"><svg class="iconify-svg block select-none mr-0.5 text-foreground" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="m5.41 21l.71-4h-4l.35-2h4l1.06-6h-4l.35-2h4l.71-4h2l-.71 4h6l.71-4h2l-.71 4h4l-.35 2h-4l-1.06 6h4l-.35 2h-4l-.71 4h-2l.71-4h-6l-.71 4zM9.53 9l-1.06 6h6l1.06-6z"></path></svg>Inno Setup</a><!--]--><!--]--><!--]--></div></header><div class="md-prose max-w-none dark:prose-invert mt-6" data-v-de2a0df0=""><!--[--><p data-v-de2a0df0="">最近在做一个 Electron 桌面应用，需要实现文件关联，把特定后缀的文件关联到应用上，双击文件可以直接打开应用并读取文件。</p><p data-v-de2a0df0="">文件关联与操作系统相关性比较大，不同的操作系统实现方式也会不同。不过如果使用 <a href="https://www.electron.build/" target="_blank" class="" data-v-de2a0df0=""><!--[-->electron-builder<!--]--></a> 进行应用打包，可以直接通过 <a href="configuration/configuration.html#overridable-per-platform-options" class="" data-v-de2a0df0=""><!--[-->fileAssociations<!--]--></a> 配置来实现文件关联。</p><p data-v-de2a0df0="">而我这边使用 <a href="https://github.com/electron/electron-packager" target="_blank" class="" data-v-de2a0df0=""><!--[-->electron-packager<!--]--></a> 打包，不会直接产出安装程序，所以需要自行实现文件关联，同时可以借机进一步了解 Windows 和 Mac 实现文件关联的细节。</p><a id="more" href="#more" class="block" data-v-de2a0df0=""></a><h2 id="%E6%96%87%E4%BB%B6%E5%85%B3%E8%81%94" data-v-de2a0df0="">文件关联<a name="%E6%96%87%E4%BB%B6%E5%85%B3%E8%81%94" class="headerlink" href="#%E6%96%87%E4%BB%B6%E5%85%B3%E8%81%94" data-v-de2a0df0=""></a></h2><p data-v-de2a0df0="">文件关联的实现和表现在不同的操作系统上会有所不同，但核心期望是一致的：</p><ul data-v-de2a0df0=""><li data-v-de2a0df0="">应用安装完成后，特定的文件类型会自动关联到应用上，文件图标需要根据配置有所变化</li><li data-v-de2a0df0="">双击能够直接通过目标应用打开；或者右键在其他应用中能够选择目标应用</li><li data-v-de2a0df0="">应用卸载后，文件关联需要解除、文件图标显示的恢复</li></ul><h3 id="Windows" data-v-de2a0df0="">Windows<a name="Windows" class="headerlink" href="#Windows" data-v-de2a0df0=""></a></h3><p data-v-de2a0df0="">Windows 的文件关联是通过注册表实现的，注册表中的 <code data-v-de2a0df0="">HKEY_CLASSES_ROOT（HKCR）</code> 节点包含了文件扩展名关联信息。</p><blockquote data-v-de2a0df0=""><p data-v-de2a0df0="">在实际的注册表中，不推荐直接修改 <code data-v-de2a0df0="">HKEY_CLASSES_ROOT</code>，而是修改 <code data-v-de2a0df0="">HKEY_CURRENT_USER\Software\Classes</code> 或 <code data-v-de2a0df0="">HKEY_LOCAL_MACHINE\Software\Classes</code>。</p><p data-v-de2a0df0=""><code data-v-de2a0df0="">HKEY_CLASSES_ROOT</code> 是 <code data-v-de2a0df0="">HKEY_LOCAL_MACHINE\Software\Classes</code> 和 <code data-v-de2a0df0="">HKEY_CURRENT_USER\Software\Classes</code> 的合并，如果两个节点中都有相同的键，那么 <code data-v-de2a0df0="">HKEY_CURRENT_USER\Software\Classes</code> 会覆盖 <code data-v-de2a0df0="">HKEY_LOCAL_MACHINE\Software\Classes</code> 中的键。</p><p data-v-de2a0df0="">本文为了表述方便，都直接使用 <code data-v-de2a0df0="">HKEY_CLASSES_ROOT</code>。</p></blockquote><p data-v-de2a0df0="">打开“注册表编辑器”，找到其中 <code data-v-de2a0df0="">HKEY_CLASSES_ROOT\.js</code> 节点，该节点存储了 <code data-v-de2a0df0="">.js</code> 文件类型的关联信息；<code data-v-de2a0df0="">HKEY_CLASSES_ROOT\VSCode.js</code> 节点存储了 <code data-v-de2a0df0="">.js</code> 文件类型的默认应用信息。</p><blockquote data-v-de2a0df0=""><p data-v-de2a0df0="">注：这里是以 vscode 的注册表信息为例，需要安装了 vscode 才会有这些内容。</p></blockquote><p data-v-de2a0df0=""><img alt="1-registry-js.png" loading="lazy" title="1-registry-js.png" class="post-image" src="/assets/1-registry-js-BQfYOQbA.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-de2a0df0=""></p><p data-v-de2a0df0="">要实现文件关联，就要做到图中的效果，根据理解，主要包含两个步骤：</p><ol data-v-de2a0df0=""><li data-v-de2a0df0=""><p data-v-de2a0df0="">注册应用程序 ProgId，即图中的 <code data-v-de2a0df0="">VSCode.js</code></p><ul data-v-de2a0df0=""><li data-v-de2a0df0="">DefaultIcon：设置文件图标</li><li data-v-de2a0df0="">shell\open\command：设置通过文件打开时的命令，<code data-v-de2a0df0="">%1</code> 就是目标文件的路径，这里会影响程序中的读取</li></ul></li><li data-v-de2a0df0=""><p data-v-de2a0df0="">注册文件扩展名关联信息，即图中的 <code data-v-de2a0df0="">.js</code>，在 <code data-v-de2a0df0="">OpenWithProgids</code> 中设置关联的应用程序，上图中的 <code data-v-de2a0df0="">VSCode.js</code> 就是关联的目标应用</p></li></ol><p data-v-de2a0df0="">我的应用程序使用 <code data-v-de2a0df0="">Inno Setup</code> 制作安装程序，基于 <code data-v-de2a0df0="">Inno Setup</code> 可以很方便地在安装/卸载过程修改注册表。</p><p data-v-de2a0df0="">比如有一个 <code data-v-de2a0df0="">MyProg.exe</code> 程序，想要关联 <code data-v-de2a0df0="">.myp</code> 后缀的文件，那么 Inno Setup 脚本可以是这样（只保留了关键信息）：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-de2a0df0=""><code data-v-de2a0df0=""><span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">[Setup]</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 这一行能在安装/卸载之后自动刷新资源管理器，避免图标缓存的问题</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">ChangesAssociations</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">yes</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">[Registry]</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 创建 ProgID</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; SubKey: "MyProg.myp"; ValueData: "myp 自定义文件"; ValueType: string; Flags: uninsdeletekey noerror;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 图标设置成应用程序的图标</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; SubKey: "MyProg.myp\DefaultIcon"; ValueData: "{app}\{#appExe}"; ValueType: string; Flags: uninsdeletekey noerror;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 指定打开文件的命令，设置传参方式</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; Subkey: "MyProg.myp\shell\open\command"; ValueType: string; ValueName: ""; ValueData: "{app}\{#appExe} --open-file=""%1"""; Flags: uninsdeletekey</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 指定 .myp 文件的 ProgID</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; Subkey: ".myp\OpenWithProgids"; ValueType: string; ValueName: "MyProg.myp"; ValueData: ""; Flags: uninsdeletekey</span></span></code></pre><blockquote data-v-de2a0df0=""><p data-v-de2a0df0="">实际上对于文件关联功能，可以使用 Inno Setup 的可视化操作设置关联信息，设置完之后生成脚本、再进行修改</p></blockquote><p data-v-de2a0df0="">如此便完成了文件关联的设置，安装完成后，<code data-v-de2a0df0="">.myp</code> 文件会自动关联到 <code data-v-de2a0df0="">MyProg.exe</code> 上，双击文件就可以直接打开应用了。除此之外，还可以在右键菜单上透出应用信息，当默认关联的程序不是目标程序时，可以快速找到目标程序，效果以及相应的注册表信息如下：</p><p data-v-de2a0df0=""><img alt="2-rightclick-open.png" loading="lazy" title="2-rightclick-open.png" class="post-image" src="/assets/2-rightclick-open-oBrMmyc-.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-de2a0df0=""></p><p data-v-de2a0df0="">相应脚本逻辑如下：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-de2a0df0=""><code data-v-de2a0df0=""><span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">[Registry]</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 设置右键内容</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; Subkey: "*\shell\MyProg"; ValueType: string; ValueName: ""; ValueData: "通过 MyProg 打开"; Flags: uninsdeletekey</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 设置右键打开的命令</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; Subkey: "*\shell\MyProg\command"; ValueType: string; ValueName: ""; ValueData: "{app}\{#appExe} --open-file=""%1"""; Flags: uninsdeletekey</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; 设置右键的图标</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">; Subkey: "*\shell\MyProg"; ValueType: string; ValueName: "Icon"; ValueData: "{app}\{#appExe}"; Flags: uninsdeletekey</span></span></code></pre><h4 id="%E5%88%B7%E6%96%B0%E5%9B%BE%E6%A0%87" data-v-de2a0df0="">刷新图标<a name="%E5%88%B7%E6%96%B0%E5%9B%BE%E6%A0%87" class="headerlink" href="#%E5%88%B7%E6%96%B0%E5%9B%BE%E6%A0%87" data-v-de2a0df0=""></a></h4><p data-v-de2a0df0="">基于 Inno Setup，通过设置 <code data-v-de2a0df0="">ChangesAssociations=yes</code>，可以在安装/卸载之后自动刷新资源管理器，避免图标缓存的问题。</p><p data-v-de2a0df0="">如果不是使用 Inno Setup 或是其他不支持这种快捷方式的工具，可以通过调用 <a href="https://github.com/crazy-max/IconsRefresh/" target="_blank" class="" data-v-de2a0df0=""><!--[-->IconsRefresh<!--]--></a> 来实现刷新。</p><p data-v-de2a0df0="">网上的一些实现都需要重启电脑或资源管理器，体验不是很好。这个工具无需任何重启，通过调用系统 API 来通知资源管理器刷新。</p><h3 id="Mac" data-v-de2a0df0="">Mac<a name="Mac" class="headerlink" href="#Mac" data-v-de2a0df0=""></a></h3><p data-v-de2a0df0="">在 Mac 上实现文件关联就比较简单了，对于应用程序，相关内容都在程序清单中，只需要在 <code data-v-de2a0df0="">Info.plist</code> 中添加 <code data-v-de2a0df0="">CFBundleDocumentTypes</code> 节点即可，如下：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-de2a0df0=""><code data-v-de2a0df0=""><span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">CFBundleDocumentTypes</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">array</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">dict</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    &lt;!-- 定义后缀 --&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">CFBundleTypeExtensions</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">array</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">js</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">array</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    &lt;!-- 定义图标 --&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">CFBundleTypeIconFile</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">icon.icns</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    &lt;!-- 定义描述 --&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">CFBundleTypeName</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">JavaScript File</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    &lt;!-- 定义类型，可选为 Viewer | Editor | Shell | None --&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">CFBundleTypeRole</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Editor</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    &lt;!-- 定义优先级，可选为 Owner | Alternate | None --&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">LSHandlerRank</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">key</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">Owner</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">dict</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-de2a0df0="">array</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-de2a0df0="">&gt;</span></span></code></pre><p data-v-de2a0df0="">我没有找到在 Mac 上任何通过脚本或用户操作去主动刷新图标的方式，当然对于 Mac 原生开发了解不多，也许有我不知道的方式。但经过实际测试，应用程序安装之后是可以直接生效的。</p><blockquote data-v-de2a0df0=""><p data-v-de2a0df0="">在测试的过程中发现设置的图标始终不生效（即使删除重装也没效果），不知道是不是玄学，把 CFBundleTypeIconFile 调整为紧跟在 CFBundleTypeExtensions 后面，重新打包安装后就立刻生效了。</p></blockquote><h2 id="Electron%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6" data-v-de2a0df0="">Electron 读取文件<a name="Electron%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6" class="headerlink" href="#Electron%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6" data-v-de2a0df0=""></a></h2><p data-v-de2a0df0="">因为实现方式的不同，导致 Electron 在不同系统上读取文件的方式也有所不同。</p><p data-v-de2a0df0="">对于 Windows，前文在注册表的打开方式中都定义了 <code data-v-de2a0df0="">--open-file="%1"</code>，这样在应用程序启动时，就会接收到一个 <code data-v-de2a0df0="">--open-file="C:\Users\XXX\Desktop\test.myp"</code> 的参数，通过 <code data-v-de2a0df0="">process.argv</code> 的具名参数就可以获取到文件路径了。</p><p data-v-de2a0df0="">不少 Electron 应用会保持单例的模式，即当 <code data-v-de2a0df0="">app.requestSingleInstanceLock()</code> 为非时，退出 app。而当应用程序已经启动时，再次打开文件，就会进入这个逻辑，这时候需要把参数进行透传，即：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-de2a0df0=""><code data-v-de2a0df0=""><span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0=""> (</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">  !</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">app</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">requestSingleInstanceLock</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">({</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">    openFile</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">:</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argv</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#BAEBE2;" data-v-de2a0df0="">openFile</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">,</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">  })</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">) {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">  app</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">exit</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">();</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">} </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">else</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">  // ...</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">}</span></span></code></pre><p data-v-de2a0df0="">同时会触发 <code data-v-de2a0df0="">second-instance</code> 事件，通过回调参数获取文件路径。</p><p data-v-de2a0df0="">对于 Mac，事情又简单了，监听 <code data-v-de2a0df0="">open-file</code> 事件即可，通过回调参数获取文件路径。</p><p data-v-de2a0df0="">总体逻辑大概如下：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-de2a0df0=""><code data-v-de2a0df0=""><span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">const</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argv</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> }</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> require</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-de2a0df0="">yargs</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">);</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argvParser</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> require</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-de2a0df0="">yargs-parser</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">);</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> main</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-de2a0df0=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">  // 控制单例</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">  if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0=""> (</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">    !</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">app</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">requestSingleInstanceLock</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">{</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">      openFile</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">:</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argv</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-de2a0df0="">openFile</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-de2a0df0="">,</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">)</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">  )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    app</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">exit</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">  }</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">  if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0=""> (</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">process</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-de2a0df0="">platform</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> ===</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-de2a0df0="">darwin</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    // Mac</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    app</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">on</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-de2a0df0="">open-file</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-de2a0df0="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-de2a0df0=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-de2a0df0="">e</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-de2a0df0="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> filepath</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">      // ...</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">  }</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> else</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    // Windows</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    // 第一次启动</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> filepath</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argv</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-de2a0df0="">openFile</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    // 运行状态再次打开</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">    app</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">on</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-de2a0df0="">second-instance</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">'</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-de2a0df0="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-de2a0df0=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-de2a0df0="">e</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-de2a0df0="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argvs</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-de2a0df0="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0=""> {</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">      const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argvObject</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argvParser</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-de2a0df0="">argvs</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0="">      const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> secondFilepath</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-de2a0df0=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-de2a0df0=""> argvObject</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-de2a0df0="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-de2a0df0="">openFile</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">  }</span></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-de2a0df0="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">;</span></span>
<span class="line" data-v-de2a0df0=""></span>
<span class="line" data-v-de2a0df0=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-de2a0df0="">main</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-de2a0df0="">();</span></span></code></pre><h2 id="%E7%BB%93%E8%AF%AD" data-v-de2a0df0="">结语<a name="%E7%BB%93%E8%AF%AD" class="headerlink" href="#%E7%BB%93%E8%AF%AD" data-v-de2a0df0=""></a></h2><p data-v-de2a0df0="">文件关联是常见的需求，本身并不复杂，但由于原生应用开发知识的匮乏，期间找了不少资料、也问了 GPT，从完全不了解到有了头绪，总归是有了一些收获。</p><p data-v-de2a0df0="">期间在图标缓存问题上搞了很久，一开始并不知道 Inno Setup 可以设置 ChangeAssociations 来实现资源管理器的刷新，而是找了很多资料、尝试去自行现实，而各种方式的效果还都不理想。再后来找到了 IconsRefresh，发现这个工具的效果是我想要的，并进行了接入。完了之后看到 Inno Setup 直接有这个属性，一口老血，多费了不少时间。</p><hr data-v-de2a0df0=""><p data-v-de2a0df0="">参考资料：</p><ul data-v-de2a0df0=""><li data-v-de2a0df0="">注册表：<a href="https://learn.microsoft.com/zh-cn/windows/win32/sysinfo/registry" target="_blank" class="" data-v-de2a0df0=""><!--[-->https://learn.microsoft.com/zh-cn/windows/win32/sysinfo/registry<!--]--></a></li><li data-v-de2a0df0="">文件类型：<a href="https://learn.microsoft.com/zh-cn/windows/win32/shell/fa-file-types" target="_blank" class="" data-v-de2a0df0=""><!--[-->https://learn.microsoft.com/zh-cn/windows/win32/shell/fa-file-types<!--]--></a></li><li data-v-de2a0df0="">“黑客”入门学习之“Windows 注册表”：<a href="https://www.toutiao.com/article/6633692159113429512/" target="_blank" class="" data-v-de2a0df0=""><!--[-->https://www.toutiao.com/article/6633692159113429512/<!--]--></a></li><li data-v-de2a0df0="">“打开方式”的“打开方式”：<a href="https://geelaw.blog/entries/windows-fileassoc-walkthru/#register-fileassoc" target="_blank" class="" data-v-de2a0df0=""><!--[-->https://geelaw.blog/entries/windows-fileassoc-walkthru/#register-fileassoc<!--]--></a></li><li data-v-de2a0df0="">如何自定义右键菜单：<a href="https://answers.microsoft.com/zh-hans/windows/forum/all/%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89win11/c1050975-64cf-425c-b940-9aeda0ed714c" target="_blank" class="" data-v-de2a0df0=""><!--[-->https://answers.microsoft.com/zh-hans/windows/forum/all/%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89win11/c1050975-64cf-425c-b940-9aeda0ed714c<!--]--></a></li><li data-v-de2a0df0="">如何刷新 explorer.exe 图标缓存：<a href="https://lazywang.life/2022/05/23/how-to-refresh-explorer-icon-cache/" target="_blank" class="" data-v-de2a0df0=""><!--[-->https://lazywang.life/2022/05/23/how-to-refresh-explorer-icon-cache/<!--]--></a></li></ul><!--]--></div></article><aside class="pointer-events-none fixed z-20 top-0 w-full h-full left-0 overscroll-contain transition-300 lg:pointer-events-auto lg:absolute lg:w-auto lg:bg-transparent lg:left-[calc(100%+clamp(6px,17.1875vw-176px,50px))]" data-v-de2a0df0=""><nav class="overflow-y-auto text-foreground overscroll-contain bg-background w-74 max-w-4/5 h-full py-8 px-6 rounded-tl-xl rounded-bl-xl absolute top-0 transition-300 right-0 translate-x-full lg:p-0 lg:max-w-44 xl:max-w-50 lg:h-auto lg:max-h-[calc(100vh-130px)] lg:rounded-none lg:sticky lg:top-10 lg:right-auto lg:translate-x-0 lg:bg-transparent lg:ml-0" data-v-de2a0df0=""><h2 class="mb-2 font-bold lg:hidden" data-v-de2a0df0="">TABLE OF CONTENTS</h2><ul class="group/root" data-v-de2a0df0=""><!--[--><li><a href="#%E6%96%87%E4%BB%B6%E5%85%B3%E8%81%94" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="文件关联">文件关联</span></a><ul class=""><!--[--><li><a href="#Windows" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Windows">Windows</span></a><ul class=""><!--[--><li><a href="#%E5%88%B7%E6%96%B0%E5%9B%BE%E6%A0%87" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="刷新图标">刷新图标</span></a><!----></li><!--]--></ul></li><li><a href="#Mac" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Mac">Mac</span></a><!----></li><!--]--></ul></li><li><a href="#Electron%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Electron 读取文件">Electron 读取文件</span></a><!----></li><li><a href="#%E7%BB%93%E8%AF%AD" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="结语">结语</span></a><!----></li><!--]--></ul></nav></aside></div><hr class="border-border mt-10" data-v-de2a0df0=""><div class="mt-10" data-v-de2a0df0=""><div data-v-de2a0df0=""><h2 class="text-xl font-bold mb-5"><a href="#comment" class="text-accent foreground-link">留言板</a></h2><div class="utterances-wrapper"></div></div></div><!--]--></main><footer class="text-center py-6 text-gray-500 dark:text-gray-400 text-sm"><div><span>© 2017-2025 Daief's Blog</span></div></footer><div></div></div><!--]--></div>
<script>window.__INITIAL_STATE__="{\"naiveUiStyles\":\"\"}"</script>
  

</body></html>