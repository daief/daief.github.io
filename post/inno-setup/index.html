<!DOCTYPE html><html ssthtmlattrs="" lang="en"><head>
    <title>Inno Setup | Daief's Blog</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--ssr-head-partial-->
    <script>
      if (/MSIE \d|Trident.*rv:/.test(navigator.userAgent)) {
        // redirect IE to Edge
        // This browser is no longer supported
        window.location.href = 'microsoft-edge:' + window.location.href;
        alert('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
        throw new Error('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
      }
    </script>
    <script type="module" crossorigin="" src="/assets/app-DvX1Smg_.js"></script>
    <link rel="stylesheet" crossorigin="" href="/assets/app-lBf8QYnm.css">
  <link rel="modulepreload" crossorigin="" href="/assets/vm__post_inno-setup_-DEUx_van.js"><link rel="stylesheet" href="/assets/vm__post_inno-setup_-JA_Loa8N.css"><link rel="modulepreload" crossorigin="" href="/assets/meta-info-C-tMy3g2.js"><link rel="modulepreload" crossorigin="" href="/assets/toc-DNILfFl5.js"><link rel="stylesheet" href="/assets/toc-m8VwwUnR.css"><meta name="description" content="Inno Setup 初学者的整理文档，覆盖了 ISS 脚本中的大部分 Section。"><meta property="og:title" content="Inno Setup | Daief's Blog"><meta property="og:description" content="Inno Setup 初学者的整理文档，覆盖了 ISS 脚本中的大部分 Section。"><meta property="og:image" content="https://avatars.githubusercontent.com/u/19222089?v=4"><meta name="author" content="daief"></head>
  <body ssrbodyattrs="">
    <div class="page-bg-gradient pointer-events-none fixed start-0 top-0 z-[-1] h-screen w-full"></div>
    <div id="app" data-server-rendered="true"><!--[--><div class="flex flex-col min-h-screen transition-colors duration-300"><header data-v-c69b61b1=""><div id="nav-container" class="max-w-app mx-auto text-foreground sm:bg-transparent" data-v-c69b61b1=""><div id="top-nav-wrap" class="relative grid grid-cols-2 auto-rows-auto w-full items-center justify-between p-4 sm:py-6 sm:flex sm:grid-rows-1" data-v-c69b61b1=""><a href="/" class="py-1 text-xl leading-8 font-semibold whitespace-nowrap sm:my-auto sm:text-2xl sm:leading-none" data-v-c69b61b1=""><!--[-->Daief's Blog<!--]--></a><div class="flex-center justify-end space-x-4 sm:hidden" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button><a role="button" class="text-2xl p-1" data-v-c69b61b1=""><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-c69b61b1=""><path fill="currentColor" d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></a></div><nav id="nav-menu" class="col-start-1 col-end-3 w-full flex-col items-center static top-full left-0 right-0 z-10 mt-4 sm:mt-0 sm:ms-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0 sm:flex hidden" data-v-c69b61b1=""><ul id="menu-items" class="w-full place-content-center gap-2 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0" data-v-c69b61b1=""><!--[--><li class="col-span-2" data-v-c69b61b1=""><a href="/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1 nav-active" data-v-c69b61b1=""><!--[-->文章<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/tags/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->标签<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/about/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->关于<!--]--></a></li><!--]--><li class="col-span-1 hidden sm:block" data-v-c69b61b1=""><a class="flex justify-center items-center h-full px-4 py-3 sm:px-2 sm:py-1" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button></a></li></ul></nav></div></div><div class="mx-auto max-w-app px-4" data-v-c69b61b1=""><hr class="border-border" aria-hidden="true" data-v-c69b61b1=""></div></header><main class="flex-grow max-w-app mx-auto px-4 py-8 w-full text-foreground"><!--[--><div class="relative" data-v-1dc8ddbb=""><article data-v-1dc8ddbb=""><header data-v-1dc8ddbb=""><h1 class="text-foreground text-3xl font-bold mb-4" data-v-1dc8ddbb=""> Inno Setup </h1><div class="flex items-center gap-x-3.5 gap-y-0.5 text-foreground opacity-80 flex-wrap" data-v-1dc8ddbb=""><!--[--><!--[--><div class="inline-flex items-center gap-x-0.5 whitespace-nowrap"><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="M7 11h2v2H7zm14-6v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2M5 7h14V5H5zm14 12V9H5v10zm-4-6v-2h2v2zm-4 0v-2h2v2zm-4 2h2v2H7zm8 2v-2h2v2zm-4 0v-2h2v2z"></path></svg><span>发表于：<time datetime="2023-04-07T11:28:06.000Z">2023/04/07</time></span></div><!--[--><a href="/tags/Inno%20Setup/1/" class="inline-flex items-center foreground-link"><svg class="iconify-svg block select-none mr-0.5 text-foreground" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="m5.41 21l.71-4h-4l.35-2h4l1.06-6h-4l.35-2h4l.71-4h2l-.71 4h6l.71-4h2l-.71 4h4l-.35 2h-4l-1.06 6h4l-.35 2h-4l-.71 4h-2l.71-4h-6l-.71 4zM9.53 9l-1.06 6h6l1.06-6z"></path></svg>Inno Setup</a><!--]--><!--]--><!--]--></div></header><div class="md-prose max-w-none dark:prose-invert mt-6" data-v-1dc8ddbb=""><!--[--><p data-v-1dc8ddbb="">最近工作上遇到了 Inno Setup，这对于我来说是个新东西，看不懂，那么就学一下吧。</p><a id="more" href="#more" class="block" data-v-1dc8ddbb=""></a><h2 id="%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5" data-v-1dc8ddbb="">安装 &amp; 起步<a name="%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5" class="headerlink" href="#%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5" data-v-1dc8ddbb=""></a></h2><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">当前所使用的 Inno Setup 版本是 6.2.2</p></blockquote><p data-v-1dc8ddbb="">Inno Setup（后文将简称为 Inno） 是一个开源的安装包制作工具，小巧但强大，官网下载地址：<a href="https://jrsoftware.org/isinfo.php" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://jrsoftware.org/isinfo.php<!--]--></a>。</p><p data-v-1dc8ddbb="">官方文档：<a href="https://jrsoftware.org/ishelp/" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://jrsoftware.org/ishelp/<!--]--></a></p><p data-v-1dc8ddbb="">下载安装之后打开 Inno，实际上是一个编辑器，可以直接编辑脚本，可以编译、运行脚本，生成安装程序。</p><p data-v-1dc8ddbb="">选择新建脚本，写入以下内容：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Setup]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">My Program</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppVersion</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">1.0.0</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">DefaultDirName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{userdesktop}\hello</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span></span></code></pre><p data-v-1dc8ddbb="">点击编译（Compile），在对话框中选择保存脚本（比如 hello.iss），之后在脚本的同级会生成一个 <code data-v-1dc8ddbb="">Output</code>，里面有一个 <code data-v-1dc8ddbb="">mysetup.exe</code>。</p><p data-v-1dc8ddbb="">双击 <code data-v-1dc8ddbb="">mysetup.exe</code> 就开始安装引导了：</p><p data-v-1dc8ddbb=""><img alt="01-hello-installer.png" loading="lazy" title="01-hello-installer.png" class="post-image" src="/assets/01-hello-installer-un02f50d.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-1dc8ddbb=""></p><p data-v-1dc8ddbb="">回顾上述脚本：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Setup]</code>：此部分包含安装程序和卸载程序使用的全局设置，该 <code data-v-1dc8ddbb="">Section</code> 是必须的</li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">AppName</code> 和 <code data-v-1dc8ddbb="">AppVersion</code> 分别定义应用程序的名称和版本</li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">DefaultDirName</code> 是默认的安装目录，这里使用了一个<strong data-v-1dc8ddbb="">常量</strong> <code data-v-1dc8ddbb="">userdesktop</code>，表示用户桌面的路径</li></ul><p data-v-1dc8ddbb="">根据安装引导的提示完成安装，最终会在指定路径创建一个文件夹，包含如下卸载程序：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">unins000.dat</li><li data-v-1dc8ddbb="">unins000.exe</li></ul><p data-v-1dc8ddbb="">除了手写脚本，Inno 本身自带可视化的界面去制作安装程序，在可视化界面中一步步进行下去，最后可以将一系列操作保存为一份脚本。可视化的操作很方便易学，不过这里不对可视化操作进行过多介绍了，主要还是学习一下脚本的编写。</p><h2 id="%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0" data-v-1dc8ddbb="">脚本学习<a name="%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0" class="headerlink" href="#%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0" data-v-1dc8ddbb=""></a></h2><h3 id="iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88" data-v-1dc8ddbb="">iss 脚本概览<a name="iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88" class="headerlink" href="#iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">每一个 iss 脚本由若干个 <code data-v-1dc8ddbb="">Section</code> 组成，每个 <code data-v-1dc8ddbb="">Section</code> 有各自的职责。一个 <code data-v-1dc8ddbb="">Section</code> 由方括号 <code data-v-1dc8ddbb="">[]</code> 包裹，其中包含 <code data-v-1dc8ddbb="">Section</code> 的名称。在每个 <code data-v-1dc8ddbb="">Section</code> 内可以包含任意数量的条目。</p><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">Section</code> 可以分为两类：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">像 <code data-v-1dc8ddbb="">[Setup]</code> 这样，它的条目由指令名称和值（形式为 Directive=Value）构成</li><li data-v-1dc8ddbb="">以及像 <code data-v-1dc8ddbb="">[Files]</code> 这样，它的条目是由多个键值对通过分号连接而成，这种形式下的键值对又称为参数（Parameter）</li></ul><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Setup]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">My Program</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Files]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.EXE</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"</span></span></code></pre><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">注意：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">每个 <code data-v-1dc8ddbb="">Section</code> 内部的条目可以使用相同的名称</li><li data-v-1dc8ddbb="">可以存在多个同名 <code data-v-1dc8ddbb="">Section</code></li><li data-v-1dc8ddbb="">默认情况下，指令值中的任何前导或尾随空格都将被删除。可以通过在指令值周围加上双引号 <code data-v-1dc8ddbb="">"</code> 来避免</li><li data-v-1dc8ddbb="">iss 本身大小写不敏感，但是需要注意有些“值”的书写方式，比如应用名称会在某些地方直接展示给用户，故不可随意书写</li></ul></blockquote><p data-v-1dc8ddbb="">iss 的注释由 <code data-v-1dc8ddbb="">;</code> 开头，<code data-v-1dc8ddbb="">[Code]</code> 部分的注释另有两种方式：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Setup]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; AppName 指定应用程序的名称，这是一条注释</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">My Program</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Code]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">// 单行注释</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">(* 多行注释 *)</span></span></code></pre><p data-v-1dc8ddbb="">支持类似 C 语言的 <code data-v-1dc8ddbb="">#include</code> 指令，它可以将另一个文件中的内容插入到脚本中指令所在的位置。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">#</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">include</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb=""> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">filename.txt</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span></span></code></pre><p data-v-1dc8ddbb="">如果文件名不是绝对路径，编译器将在 iss 文件所在目录中查找。文件名可以以 <code data-v-1dc8ddbb="">compiler:</code> 为前缀，在这种情况下，它会在编译器目录中查找该文件。</p><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">compiler:</code> 为前缀时，查找编译器目录，指的就是 Inno Setup 的安装目录。</p></blockquote><p data-v-1dc8ddbb="">支持 <code data-v-1dc8ddbb="">#preproc</code> 指令，该指令指定是否使用内置预处理器（仅支持上述 #include 指令）或使用 Inno 预处理器 (ISPP)，后者支持更多的指令。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span data-v-1dc8ddbb="">#preproc builtin</span></span>
<span class="line" data-v-1dc8ddbb=""><span data-v-1dc8ddbb="">#preproc ispp</span></span></code></pre><p data-v-1dc8ddbb="">默认情况下，iss 脚本使用 ISPP（如果可用），而 .isl 文件使用内置（built-in）预处理器。</p><h3 id="%E5%A4%9A%E8%AF%AD%E8%A8%80" data-v-1dc8ddbb="">多语言<a name="%E5%A4%9A%E8%AF%AD%E8%A8%80" class="headerlink" href="#%E5%A4%9A%E8%AF%AD%E8%A8%80" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">Inno 官方自带一部分多语言，可以在 Inno 安装目录下的 <code data-v-1dc8ddbb="">Languages</code> 文件夹中找到。</p><p data-v-1dc8ddbb="">对于官方未支持的多语言（比如中文），可以在 <a href="https://jrsoftware.org/files/istrans/" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://jrsoftware.org/files/istrans/<!--]--></a> 下载，下载之后保存到 Inno 的 <code data-v-1dc8ddbb="">Languages</code> 文件夹中，命名为 <code data-v-1dc8ddbb="">ChineseSimplified.isl</code>。</p><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">注意：文件格式不能是 UTF-8，需要是 UTF-8 with BOM 或者是 GBK 编码（可能还有其他可行的编码，但没尝试过），否则会出现中文乱码。</p></blockquote><p data-v-1dc8ddbb="">针对最开始的脚本，添加中文支持，重新编译并运行：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Setup]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">My Program</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppVersion</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">1.0.0</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">DefaultDirName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{userdesktop}\hello</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">WizardStyle</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">modern</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; 新增 Languages Section，指定为中文</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Languages]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: chinesesimp</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; MessagesFile: "compiler:Languages\ChineseSimplified.isl"</span></span></code></pre><p data-v-1dc8ddbb=""><img alt="02-hello-installer-chinese.png" loading="lazy" title="02-hello-installer-chinese.png" class="post-image" src="/assets/02-hello-installer-chinese-qY3-CEhS.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-1dc8ddbb=""></p><h3 id="%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89" data-v-1dc8ddbb="">常量（Constants）<a name="%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89" class="headerlink" href="#%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">前文 <code data-v-1dc8ddbb="">DefaultDirName="{userdesktop}\hello"</code>、<code data-v-1dc8ddbb="">Source: "MYPROG.EXE"; DestDir: "{app}"</code> 中的 <code data-v-1dc8ddbb="">userdesktop</code> 和 <code data-v-1dc8ddbb="">app</code> 都是常量，安装和卸载的过程中，常量会被替换为用户选择的值或系统配置中的值。</p><p data-v-1dc8ddbb="">比如，<code data-v-1dc8ddbb="">{app}</code> 常量会被替换为应用程序的安装目录，<code data-v-1dc8ddbb="">{userdesktop}</code> 常量会被替换为用户桌面的路径。</p><p data-v-1dc8ddbb="">完整的常量列表可以参考官方文档的常量章节。</p><h3 id="%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89" data-v-1dc8ddbb="">公共参数（Common Parameters）<a name="%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89" class="headerlink" href="#%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">公共参数是指能在所有 <code data-v-1dc8ddbb="">Section</code> 中都能被使用的参数，共有三条：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">Languages</code></li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">MinVersion</code></li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">OnlyBelowVersion</code></li></ul><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">TODO 待完善</p></blockquote><h3 id="Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb="">Components 和 Tasks 参数<a name="Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0" class="headerlink" href="#Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">除了 <code data-v-1dc8ddbb="">[Types]</code>、<code data-v-1dc8ddbb="">[Components]</code> 和 <code data-v-1dc8ddbb="">[Tasks]</code>，其他 <code data-v-1dc8ddbb="">Section</code> 都支持 <code data-v-1dc8ddbb="">Components</code> 和 <code data-v-1dc8ddbb="">Tasks</code> 两个可选参数。</p><h4 id="Components%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb="">Components 参数<a name="Components%20%E5%8F%82%E6%95%B0" class="headerlink" href="#Components%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">一个由空格分隔的组件名称列表，告诉安装程序该条目属于哪些组件。如果最终用户从此列表中选择了一个组件，则会处理该条目（例如：安装文件）。</p><p data-v-1dc8ddbb="">没有 <code data-v-1dc8ddbb="">Components</code> 参数的条目始终会被处理，除非有其他参数（比如后文的 Check）指示不应该这样做。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Files]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.EXE</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; Components: main</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.CHM</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; Components: help</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">README.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"</span></span></code></pre><h4 id="Tasks%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb="">Tasks 参数<a name="Tasks%20%E5%8F%82%E6%95%B0" class="headerlink" href="#Tasks%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">一个以空格分隔的任务名称列表，告诉安装程序该条目属于哪个任务。如果最终用户从此列表中选择了一个任务，则会处理该条目（例如：安装文件）。</p><p data-v-1dc8ddbb="">没有 <code data-v-1dc8ddbb="">Tasks</code> 参数的条目始终会被处理，除非其他参数说明不应该这样做。</p><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">请注意，在“选择开始菜单文件夹”向导页面上的“不创建开始菜单文件夹”复选框不影响具有 Tasks 参数的 <code data-v-1dc8ddbb="">[Icons]</code> 条目，因为它们有自己的复选框。</p></blockquote><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Icons]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{group}\My Program</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Filename: "{app}\MyProg.exe"; Components: main; Tasks: startmenu</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{group}\My Program Help</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Filename: "{app}\MyProg.chm"; Components: help; Tasks: startmenu</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{commondesktop}\My Program</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Filename: "{app}\MyProg.exe"; Components: main; Tasks: desktopicon</span></span></code></pre><p data-v-1dc8ddbb="">除了空格分隔的列表，还可以将布尔表达式用作组件和任务参数。支持的运算符包括 <code data-v-1dc8ddbb="">not</code>、<code data-v-1dc8ddbb="">and</code> 和 <code data-v-1dc8ddbb="">or</code>。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Components]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: a</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: b</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: b</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Tasks]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: p</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a or b; Components: a or b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: q</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a and b; Components: a and b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: r</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: not a or b; Components: not a or b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: s</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: not (a or b); Components: not (a or b)</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: t</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a or b - old style; Components: a b</span></span></code></pre><h4 id="%E5%B0%9D%E8%AF%95" data-v-1dc8ddbb="">尝试<a name="%E5%B0%9D%E8%AF%95" class="headerlink" href="#%E5%B0%9D%E8%AF%95" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">上面都是摘自官方的解释，但到底是什么表现呢？</p><p data-v-1dc8ddbb="">在脚本中新增 <code data-v-1dc8ddbb="">Components</code> 和 <code data-v-1dc8ddbb="">Tasks</code> 的相关内容，重新编译并运行：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Setup]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">My Program</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">AppVersion</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">1.0.0</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">DefaultDirName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{userdesktop}\hello</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">WizardStyle</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">modern</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Languages]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: chinesesimp</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; MessagesFile: "compiler:Languages\ChineseSimplified.isl"</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Components]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: a</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: b</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: b</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Tasks]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: p</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a or b; Components: a or b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: q</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a and b; Components: a and b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: r</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: not a or b; Components: not a or b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: s</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: not (a or b); Components: not (a or b)</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: t</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: a or b - old style; Components: a b</span></span></code></pre><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb=""><p data-v-1dc8ddbb=""><img alt="03-hello-components-tasks.png" loading="lazy" title="03-hello-components-tasks.png" class="post-image" src="/assets/03-hello-components-tasks-B4mnTxeo.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-1dc8ddbb=""></p></li><li data-v-1dc8ddbb=""><p data-v-1dc8ddbb=""><img alt="04-hello-components-tasks-2.png" loading="lazy" title="04-hello-components-tasks-2.png" class="post-image" src="/assets/04-hello-components-tasks-2-7UpHA3XJ.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-1dc8ddbb=""></p></li><li data-v-1dc8ddbb=""><p data-v-1dc8ddbb=""><img alt="05-hello-components-tasks-3.png" loading="lazy" title="05-hello-components-tasks-3.png" class="post-image" src="/assets/05-hello-components-tasks-3-CRKO5Z_X.png" onerror="this.onerror=null;this.src='/images/image-error.jpg';" data-v-1dc8ddbb=""></p></li><li data-v-1dc8ddbb=""><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Components]</code>、<code data-v-1dc8ddbb="">[Tasks]</code> 定义了组件和任务（选项）</p></li><li data-v-1dc8ddbb=""><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">Components</code>、<code data-v-1dc8ddbb="">Tasks</code> 参数就是根据条件（用户实际的选择组件或任务）来控制条目是否被处理</p></li></ul><h2 id="Sections%20%E5%AD%A6%E4%B9%A0" data-v-1dc8ddbb="">Sections 学习<a name="Sections%20%E5%AD%A6%E4%B9%A0" class="headerlink" href="#Sections%20%E5%AD%A6%E4%B9%A0" data-v-1dc8ddbb=""></a></h2><h3 id="%5BSetup%5D" data-v-1dc8ddbb="">[Setup]<a name="%5BSetup%5D" class="headerlink" href="#%5BSetup%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">文档：<a href="https://jrsoftware.org/ishelp/topic_setupsection.htm" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://jrsoftware.org/ishelp/topic_setupsection.htm<!--]--></a></p><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Setup]</code> 包含安装程序和卸载程序使用的全局设置，是必须的。同时 <code data-v-1dc8ddbb="">[Setup]</code> 下的 <code data-v-1dc8ddbb="">AppName</code>、<code data-v-1dc8ddbb="">AppVersion</code> 和 <code data-v-1dc8ddbb="">DefaultDirName</code> 指令也是必填的。</p><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Setup]</code> 包含多达 150+ 的指令，这里只挑几个过一过，实际则用到的时候再对照文档去看了。</p><p data-v-1dc8ddbb="">指令大体分为三类：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">编译相关（Compiler-related），可以理解为会影响编译行为的指令，如：<ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">Output：可以设置为 <code data-v-1dc8ddbb="">yes</code> 或 <code data-v-1dc8ddbb="">no</code>，默认为 <code data-v-1dc8ddbb="">yes</code>，如果设置为 <code data-v-1dc8ddbb="">no</code>，编译器将仅检查脚本中的错误并跳过创建安装文件</li><li data-v-1dc8ddbb="">OutputDir：指定输出目录，默认为 <code data-v-1dc8ddbb="">Output</code>，可以设置为绝对路径或相对路径</li></ul></li><li data-v-1dc8ddbb="">安装相关（Installer-related），影响安装/卸载程序的操作，如：<ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">AppName：该指令是必须，指定正在安装的应用程序名称。<strong data-v-1dc8ddbb="">不要包括版本号，因为这由 AppVersion 和/或 AppVerName 指令定义</strong>。AppName 会显示在窗口标题、向导页面和对话框中</li><li data-v-1dc8ddbb="">AppVerName：该指令包含应用的名称和版本号，默认由 AppName 与 AppVersion 拼接而成，如果未设置 AppVersion 则该指令是必须的</li></ul></li><li data-v-1dc8ddbb="">和修饰类（Cosmetic），只影响安装程序的外观，如：<ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">SetupIconFile：指定安装/卸载程序的图标，编译器会在源目录中查找图标文件，除非是绝对路径或以 <code data-v-1dc8ddbb="">compiler:</code> 开头的路径</li></ul></li></ul><h3 id="%5BTypes%5D" data-v-1dc8ddbb="">[Types]<a name="%5BTypes%5D" class="headerlink" href="#%5BTypes%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">需要与 <code data-v-1dc8ddbb="">[Components]</code> 配合使用，相当于预定义一组集合，方便用户选择组件：</p><p data-v-1dc8ddbb="">唯一 Flags 参数的值是 <code data-v-1dc8ddbb="">iscustom</code>，表示该类型是自定义类型，如果不定义自定义类型，则只允许用户选择预定义的类型，并且无法再手动选择/取消选择组件。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Types]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">a</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "Full installation"</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">b</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "Compact installation"</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">c</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "Custom installation"; Flags: iscustom</span></span></code></pre><h3 id="%5BComponents%5D" data-v-1dc8ddbb="">[Components]<a name="%5BComponents%5D" class="headerlink" href="#%5BComponents%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">前文已有介绍，这里只说明与 <code data-v-1dc8ddbb="">[Types]</code> 配合的使用：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Components]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">c1</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "c1"; Types: a b c; Flags: fixed</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">c2</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "c2"; Types: a b</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">c3</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "c3"; Types: a</span></span></code></pre><p data-v-1dc8ddbb="">因为定义了 <code data-v-1dc8ddbb="">[Types]</code>，组件选择时会有三个选项，分别是 <code data-v-1dc8ddbb="">Full installation</code>、<code data-v-1dc8ddbb="">Compact installation</code> 和 <code data-v-1dc8ddbb="">Custom installation</code>：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">选择 <code data-v-1dc8ddbb="">Full installation</code> 会自动勾上 <code data-v-1dc8ddbb="">c1</code>、<code data-v-1dc8ddbb="">c2</code> 和 <code data-v-1dc8ddbb="">c3</code></li><li data-v-1dc8ddbb="">选择 <code data-v-1dc8ddbb="">Compact installation</code> 会自动勾上 <code data-v-1dc8ddbb="">c1</code> 和 <code data-v-1dc8ddbb="">c2</code></li><li data-v-1dc8ddbb="">若用户选择 <code data-v-1dc8ddbb="">Custom installation</code>，则可以手动勾选 <code data-v-1dc8ddbb="">c2</code> 和 <code data-v-1dc8ddbb="">c3</code></li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">c1</code> 指定了 fixed，因此用户无法手动修改该选项</li></ul><h3 id="%5BDirs%5D" data-v-1dc8ddbb="">[Dirs]<a name="%5BDirs%5D" class="headerlink" href="#%5BDirs%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Dirs]</code> 定义了除用户选择的应用程序目录（自动创建）之外，安装程序需要创建的其他目录。在主应用程序目录下创建子目录是该 Section 常见的使用方式。</p><p data-v-1dc8ddbb="">请注意，在使用 [Files] 部分安装文件时，不必显式地创建目录，因此该 Section 主要用于创建空目录。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Dirs]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{app}\data</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{app}\bin</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span></span></code></pre><h3 id="%5BFiles%5D" data-v-1dc8ddbb="">[Files]<a name="%5BFiles%5D" class="headerlink" href="#%5BFiles%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">该 Section 定义了安装程序需要安装的文件。换句话说，就是将定义的 Source 文件打包到安装程序中，安装的时候根据配置分别解压到特定目录。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Files]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">README.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; Flags: isreadme</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; 支持通配符</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">subdir\*</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}\subdir"; Flags: isreadme</span></span></code></pre><h3 id="%5BIcons%5D" data-v-1dc8ddbb="">[Icons]<a name="%5BIcons%5D" class="headerlink" href="#%5BIcons%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">该 Section 定义了安装程序如何在开始菜单或其他位置（如桌面）创建快捷方式。</p><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">myapp.exe 是最终的可执行程序，也可以使用 Inno 自带的 demo 程序：<code data-v-1dc8ddbb="">Inno 安装目录\Examples\MyProg.exe</code>。</p></blockquote><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Icons]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; 创建桌面快捷方式</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Name: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{group}\My Program</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Filename: "{app}\myapp.exe"; WorkingDir: "{app}"</span></span></code></pre><h3 id="%5BRegistry%5D" data-v-1dc8ddbb="">[Registry]<a name="%5BRegistry%5D" class="headerlink" href="#%5BRegistry%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">该 Section 定义了安装程序如何在注册表中创建、修改或删除键/值。</p><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">默认情况下，安装程序创建的注册表键和值在卸载时不会被删除。如果希望卸载程序的同时删除键或值，则 Flags 中须至少包含 uninsdelete、uninsdeletekeyifempty、uninsdeletevalue 中的一个。</p></blockquote><p data-v-1dc8ddbb="">下面是注册伪协议的例子，可通过在浏览器中输入 <code data-v-1dc8ddbb="">myapp://</code> 来打开应用程序：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Registry]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; SubKey: Myapp; ValueData: "MyappProtocol"; ValueType: string; Flags: createvalueifdoesntexist uninsdeletekey noerror;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; SubKey: Myapp; ValueName: "URL Protocol"; ValueData: "{app}\myapp.exe"; ValueType: string; Flags: createvalueifdoesntexist uninsdeletekey noerror;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; SubKey: Myapp\DefaultIcon; ValueData: "{app}\myapp.exe"; ValueType: string; Flags: createvalueifdoesntexist uninsdeletekey noerror;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Root: HKCR</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; SubKey: Myapp\shell\open\command; ValueData: "{app}\myapp.exe --open-url=""%1"""; Flags: uninsdeletekey noerror; ValueType: string;</span></span></code></pre><p data-v-1dc8ddbb="">Flags 说明：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">createvalueifdoesntexist：注册表中不存在时才创建相应条目</li><li data-v-1dc8ddbb="">uninsdeletekey：卸载时删除该键</li><li data-v-1dc8ddbb="">noerror：不展示注册表键或值设置失败的信息</li></ul><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">官方不建议直接操作注册表 HKCR，而是使用 <code data-v-1dc8ddbb="">HKA\Software\Classes</code> 作为替代。理由暂时不清楚，同时注册表的相关知识也只了解了零星半点，边学边搞吧。</p></blockquote><h3 id="%5BRun%5D%20%26%20%5BUninstallRun%5D" data-v-1dc8ddbb="">[Run] &amp; [UninstallRun]<a name="%5BRun%5D%20%26%20%5BUninstallRun%5D" class="headerlink" href="#%5BRun%5D%20%26%20%5BUninstallRun%5D" data-v-1dc8ddbb=""></a></h3><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Run]</code> 定义了在安装完成之后需要执行的程序</li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[UninstallRun]</code> 定义了在卸载第一步需要执行的程序</li></ul><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Run]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; 安装完成最后一步，关闭安装向导后是否允许 myapp.exe</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Filename: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{app}\myapp.exe</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Description: "Run myapp"; Flags: nowait postinstall skipifsilent</span></span></code></pre><h2 id="Pascal%20%E8%84%9A%E6%9C%AC" data-v-1dc8ddbb="">Pascal 脚本<a name="Pascal%20%E8%84%9A%E6%9C%AC" class="headerlink" href="#Pascal%20%E8%84%9A%E6%9C%AC" data-v-1dc8ddbb=""></a></h2><p data-v-1dc8ddbb="">除了上面看起来像是”配置式”的内容，Inno 还支持添加脚本（语法为 <a href="https://zh.wikipedia.org/zh-sg/Object_Pascal" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->Object Pascal<!--]--></a>）以实现自定义的逻辑，具有更多的创造性，比如：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">支持在自定义条件下中止安装或卸载</li><li data-v-1dc8ddbb="">支持在运行时添加自定义引导页面</li><li data-v-1dc8ddbb="">支持在安装之前、期间或之后通过 Pascal 脚本来提取、调用 DLL 或其他文件</li><li data-v-1dc8ddbb="">支持编写常量，这些常量可以执行普通常量、从注册表读取、从 ini 读取和从命令行读取等操作</li><li data-v-1dc8ddbb="">支持在运行时根据自定义条件删除 <code data-v-1dc8ddbb="">[Types]</code>、<code data-v-1dc8ddbb="">[Components]</code> 或 <code data-v-1dc8ddbb="">[Tasks]</code></li><li data-v-1dc8ddbb="">基于自定义条件，支持有条件地安装 <code data-v-1dc8ddbb="">[Files]</code>、<code data-v-1dc8ddbb="">[Registry]</code>、<code data-v-1dc8ddbb="">[Run]</code> 等条目</li><li data-v-1dc8ddbb="">提供了大量辅助函数，可通过 Pascal 脚本完成 Inno Setup 所能做到的几乎所有事情</li></ul><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">注意：从这里开始，若无特殊说明，脚本特指 <code data-v-1dc8ddbb="">[Code]</code> 中的 Pascal 脚本，脚本仅在运行时执行，因此不能干涉 iss 本身的编译</p></blockquote><h3 id="%5BCode%5D" data-v-1dc8ddbb="">[Code]<a name="%5BCode%5D" class="headerlink" href="#%5BCode%5D" data-v-1dc8ddbb=""></a></h3><p data-v-1dc8ddbb="">所有脚本内容的定义需要位于该 Section。</p><h4 id="%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0" data-v-1dc8ddbb="">事件函数<a name="%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0" class="headerlink" href="#%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">可以在 <code data-v-1dc8ddbb="">[Code]</code> 定义事件回调函数，在适当的时机会被执行，例：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Code]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">function</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-1dc8ddbb=""> InitializeSetup</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">(): </span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">Boolean</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">  begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> (Msgbox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">是否继续安装</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbConfirmation, MB_YESNO) = IDYES) </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">then</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">      Result</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> := </span><span style="--shiki-light:#1976D2;--shiki-dark:#82AAFF;" data-v-1dc8ddbb="">True</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">    else</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">      Result</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> := </span><span style="--shiki-light:#1976D2;--shiki-dark:#82AAFF;" data-v-1dc8ddbb="">False</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">    end</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">  end</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">.</span></span></code></pre><p data-v-1dc8ddbb="">定义事件函数 InitializeSetup，该函数会在安装初始化的时候被调用，返回值为 Boolean，如果返回 True 则继续安装，否则中止安装。上面的例子中，在初始化过程中加入了“弹出确认框”的逻辑，询问用户是否继续安装。</p><p data-v-1dc8ddbb="">通常情况下，同一个事件只能定义一个回调函数的实现。但使用事件属性（Event Attributes）可以在脚本中拥有同一事件函数的多个实现。这在包含了实现事件函数的外部脚本中特别有用，以避免与主要脚本发生冲突。</p><p data-v-1dc8ddbb="">以下是一个示例脚本，其中包含三个 InitializeWizard 事件函数的实现，每次触发会弹一个提示框，一共会弹三次：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">procedure</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-1dc8ddbb=""> InitializeWizard</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  SuppressibleMsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">InitializeWizard called 1</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK, IDOK);</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">&lt;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">event</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">InitializeWizard</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">)&gt;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">procedure</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-1dc8ddbb=""> InitializeWizard2</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  SuppressibleMsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">InitializeWizard called 2</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK, IDOK);</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">&lt;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">event</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">InitializeWizard</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">)&gt;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">procedure</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-1dc8ddbb=""> InitializeWizard3</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  SuppressibleMsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">InitializeWizard called 3</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK, IDOK);</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span></code></pre><p data-v-1dc8ddbb="">注意到，第二个定义需要使用了 <code data-v-1dc8ddbb="">procedure</code> 关键字，而不是 <code data-v-1dc8ddbb="">function</code>，两者都是子程序，但又有区别，简单来说：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">procedure</code> 表示过程，不会直接返回值</li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">function</code> 是函数，返回单个值</li></ul><h4 id="%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F" data-v-1dc8ddbb="">脚本常量<a name="%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F" class="headerlink" href="#%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">这个例子演示了如何在脚本中使用常量，同时脚本中定义的函数也可以在其他地方使用，比如：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Setup]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">DefaultDirName="</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">{code:MyConst}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">"</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Code]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">function</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-1dc8ddbb=""> MyConst</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">(Param: </span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">String</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">): </span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">String</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">  Result</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> := ExpandConstant(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{userdesktop}</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">) + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">/appdest</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">;</span></span></code></pre><p data-v-1dc8ddbb="">注意，<code data-v-1dc8ddbb="">MyConst</code> 函数必须要定义一个参数。</p><p data-v-1dc8ddbb="">同时，Inno <a href="https://jrsoftware.org/ishelp/topic_scriptfunctions.htm" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->内置了许多函数<!--]--></a>可以被直接使用：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[INI]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; GetShortName</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">FileName: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{app}\MyIni.ini</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; Section: "MySettings"; Key: "ShortApp"; String: "{code:GetShortName|{app}}"</span></span></code></pre><h4 id="Check%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb="">Check 参数<a name="Check%20%E5%8F%82%E6%95%B0" class="headerlink" href="#Check%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">所有参数形式的 Section 都支持 <code data-v-1dc8ddbb="">Check</code> 参数，可以在程序过程中根据条件决定是否生效，比如：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Files]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.EXE</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; Check: MyProgCheck</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">A\MYFILE.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; Check: MyDirCheck(ExpandConstant('{app}\A'))</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">B\MYFILE.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; Check: DirExists(ExpandConstant('{app}\B'))</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Code]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">var</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  MyProgChecked: Boolean</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  MyProgCheckResult: Boolean</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">function MyProgCheck(): Boolean</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  if not MyProgChecked then begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">    MyProgCheckResult := MsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">Do you want to install MyProg.exe to </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + ExtractFilePath(CurrentFileName) + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">?</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbConfirmation, MB_YESNO) = idYes</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">    MyProgChecked := True</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  Result := MyProgCheckResult</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">function MyDirCheck(DirName: String): Boolean</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  Result := DirExists(DirName)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span></code></pre><p data-v-1dc8ddbb="">注意：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Files]</code> 中的条目如果包含通配符，<code data-v-1dc8ddbb="">Check</code> 会对每一个文件都执行一次，而不是整个条目</li></ul><h4 id="BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb="">BeforeInstall &amp; AfterInstall 参数<a name="BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0" class="headerlink" href="#BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">所有参数形式的 Section 也都支持 <code data-v-1dc8ddbb="">BeforeInstall</code> 和 <code data-v-1dc8ddbb="">AfterInstall</code>，分别是在条目安装之前、之后执行：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Files]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.EXE</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; BeforeInstall: MyBeforeInstall</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">A\MYFILE.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; BeforeInstall: MyBeforeInstall2('{app}\A\MYFILE.TXT')</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">B\MYFILE.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; BeforeInstall: MyBeforeInstall2('{app}\B\MYFILE.TXT')</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.CHM</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; BeforeInstall: Log('Before MYPROG.CHM Install')</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.EXE</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; AfterInstall: MyAfterInstall</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">A\MYFILE.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; AfterInstall: MyAfterInstall2('{app}\A\MYFILE.TXT')</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">B\MYFILE.TXT</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; AfterInstall: MyAfterInstall2('{app}\B\MYFILE.TXT')</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">Source: </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">MYPROG.CHM</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">"</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">; DestDir: "{app}"; AfterInstall: Log('After MYPROG.CHM Install')</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Code]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">procedure MyBeforeInstall()</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  MsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">About to install MyProg.exe as </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + CurrentFileName + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">.</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">procedure MyBeforeInstall2(FileName: String)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  MsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">About to install </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + FileName + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb=""> as </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + CurrentFileName + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">.</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">procedure MyAfterInstall()</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  MsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">Just installed MyProg.exe as </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + CurrentFileName + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">.</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">procedure MyAfterInstall2(FileName: String)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  MsgBox(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">Just installed </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + FileName + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb=""> as </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb=""> + CurrentFileName + </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">.</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, mbInformation, MB_OK)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span></code></pre><p data-v-1dc8ddbb="">注意：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">所有 BeforeInstall 和 AfterInstall 的函数不应该拥有返回值</li><li data-v-1dc8ddbb="">如果安装程序已确定不应处理该条目，则不会调用 BeforeInstall 或 AfterInstall 函数</li><li data-v-1dc8ddbb=""><code data-v-1dc8ddbb="">[Files]</code> 中的条目如果包含通配符，BeforeInstall 和 AfterInstall 会对每一个文件都执行一次，而不是整个条目</li></ul><h4 id="%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86" data-v-1dc8ddbb="">调用 DLLs 和 .Net 程序集<a name="%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86" class="headerlink" href="#%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86" data-v-1dc8ddbb=""></a></h4><p data-v-1dc8ddbb="">脚本可以调用外部 DLL 中的函数，这包括标准 Windows DLL 中的标准 Win32 API 函数和自定义制作的 DLL 中的自定义函数。此外，还可以调用 .NET 程序集。</p><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">先知道有这么个能力吧，实际还没用到过</p></blockquote><h4 id="%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects" data-v-1dc8ddbb="">使用 COM Automation Objects<a name="%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects" class="headerlink" href="#%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects" data-v-1dc8ddbb=""></a></h4><blockquote data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">这些概念属实没接触过，感觉上也是能直接调用一些系统或系统库的能力</p></blockquote><p data-v-1dc8ddbb="">脚本可以通过 COM Automation 对象支持来访问 COM（也称为 OLE 或 ActiveX）方法和属性。这使得可以访问标准 Windows COM 服务器、自定义 COM 服务器、Visual Basic ActiveX DLL 和 .NET 程序集，可以通过 COM Interop 进行交互。</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">IDispatch based COM<ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">可通过 CreateOleObject 和 GetActiveOleObject 来初始化基于 IDispatch 的 COM</li></ul></li><li data-v-1dc8ddbb="">IUnknown based COM<ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">如果对象没有实现 IDispatch 接口，可以使用 CreateComObject 来初始化基于 IUnknown 的 COM</li></ul></li></ul><p data-v-1dc8ddbb="">如下是一个通过 WinHttpRequest 发送 HTTP 请求的例子：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-1dc8ddbb=""><code data-v-1dc8ddbb=""><span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">[Code]</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">procedure SendHttp</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  begin</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">    WinHttpReq := CreateOleObject(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">WinHttp.WinHttpRequest.5.1</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">    WinHttpReq.Open(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">POST</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">https://api.exapmle.com</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, false)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">    WinHttpReq.SetRequestHeader(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">Content-Type</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">, </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">application/json</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">    WinHttpReq.Send(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-1dc8ddbb="">{"key":"value"}</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-1dc8ddbb="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">)</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span>
<span class="line" data-v-1dc8ddbb=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-1dc8ddbb="">  end</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-1dc8ddbb="">;</span></span></code></pre><h2 id="%E7%BB%93%E8%AF%AD" data-v-1dc8ddbb="">结语<a name="%E7%BB%93%E8%AF%AD" class="headerlink" href="#%E7%BB%93%E8%AF%AD" data-v-1dc8ddbb=""></a></h2><p data-v-1dc8ddbb="">根据文档说明，每个 Section 逐步试验下来，基本上浅浅了解了下 Inno 的各个方面。Inno 本身不难，就是各种指令、参数、Flags 以及内置函数比较多，想要全盘熟悉、用得顺手也不容易。对于 Pascal 语言，虽然没接触过，但有编程经验学点简单的写法很轻松。</p><p data-v-1dc8ddbb="">个人而言，最棘手的还是 Windows 平台开发相关的内容，比如注册表的修改，为什么改这个键，为什么设置这个值，这需要查询另外的资料；比如 <code data-v-1dc8ddbb="">[Code]</code> 脚本中，可以调用哪些能力，这也需要额外的知识和经验，这些都是我目前未接触的领域。</p><p data-v-1dc8ddbb="">总之，Inno 不难，以后随着实际使用再慢慢深入吧。</p><hr data-v-1dc8ddbb=""><p data-v-1dc8ddbb="">参考资料：</p><ul data-v-1dc8ddbb=""><li data-v-1dc8ddbb="">官方文档：<a href="https://jrsoftware.org/ishelp/" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://jrsoftware.org/ishelp/<!--]--></a></li><li data-v-1dc8ddbb="">Object Pascal：<a href="https://zh.wikipedia.org/zh-sg/Object_Pascal" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://zh.wikipedia.org/zh-sg/Object_Pascal<!--]--></a></li><li data-v-1dc8ddbb="">Pascal 教程：<a href="https://www.jc2182.com/pascal/pascal-jiaocheng.html" target="_blank" class="" data-v-1dc8ddbb=""><!--[-->https://www.jc2182.com/pascal/pascal-jiaocheng.html<!--]--></a></li></ul><!--]--></div></article><aside class="pointer-events-none fixed z-20 top-0 w-full h-full left-0 overscroll-contain transition-300 lg:pointer-events-auto lg:absolute lg:w-auto lg:bg-transparent lg:left-[calc(100%+clamp(6px,17.1875vw-176px,50px))]" data-v-1dc8ddbb=""><nav class="overflow-y-auto text-foreground overscroll-contain bg-background w-74 max-w-4/5 h-full py-8 px-6 rounded-tl-xl rounded-bl-xl absolute top-0 transition-300 right-0 translate-x-full lg:p-0 lg:max-w-44 xl:max-w-50 lg:h-auto lg:max-h-[calc(100vh-130px)] lg:rounded-none lg:sticky lg:top-10 lg:right-auto lg:translate-x-0 lg:bg-transparent lg:ml-0" data-v-1dc8ddbb=""><h2 class="mb-2 font-bold lg:hidden" data-v-1dc8ddbb="">TABLE OF CONTENTS</h2><ul class="group/root" data-v-1dc8ddbb=""><!--[--><li><a href="#%E5%AE%89%E8%A3%85%20%26%20%E8%B5%B7%E6%AD%A5" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="安装 &amp; 起步">安装 &amp; 起步</span></a><!----></li><li><a href="#%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="脚本学习">脚本学习</span></a><ul class=""><!--[--><li><a href="#iss%20%E8%84%9A%E6%9C%AC%E6%A6%82%E8%A7%88" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="iss 脚本概览">iss 脚本概览</span></a><!----></li><li><a href="#%E5%A4%9A%E8%AF%AD%E8%A8%80" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="多语言">多语言</span></a><!----></li><li><a href="#%E5%B8%B8%E9%87%8F%EF%BC%88Constants%EF%BC%89" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="常量（Constants）">常量（Constants）</span></a><!----></li><li><a href="#%E5%85%AC%E5%85%B1%E5%8F%82%E6%95%B0%EF%BC%88Common%20Parameters%EF%BC%89" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="公共参数（Common Parameters）">公共参数（Common Parameters）</span></a><!----></li><li><a href="#Components%20%E5%92%8C%20Tasks%20%E5%8F%82%E6%95%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Components 和 Tasks 参数">Components 和 Tasks 参数</span></a><ul class=""><!--[--><li><a href="#Components%20%E5%8F%82%E6%95%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Components 参数">Components 参数</span></a><!----></li><li><a href="#Tasks%20%E5%8F%82%E6%95%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Tasks 参数">Tasks 参数</span></a><!----></li><li><a href="#%E5%B0%9D%E8%AF%95" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="尝试">尝试</span></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="#Sections%20%E5%AD%A6%E4%B9%A0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Sections 学习">Sections 学习</span></a><ul class=""><!--[--><li><a href="#%5BSetup%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Setup]">[Setup]</span></a><!----></li><li><a href="#%5BTypes%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Types]">[Types]</span></a><!----></li><li><a href="#%5BComponents%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Components]">[Components]</span></a><!----></li><li><a href="#%5BDirs%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Dirs]">[Dirs]</span></a><!----></li><li><a href="#%5BFiles%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Files]">[Files]</span></a><!----></li><li><a href="#%5BIcons%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Icons]">[Icons]</span></a><!----></li><li><a href="#%5BRegistry%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Registry]">[Registry]</span></a><!----></li><li><a href="#%5BRun%5D%20%26%20%5BUninstallRun%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Run] &amp; [UninstallRun]">[Run] &amp; [UninstallRun]</span></a><!----></li><!--]--></ul></li><li><a href="#Pascal%20%E8%84%9A%E6%9C%AC" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Pascal 脚本">Pascal 脚本</span></a><ul class=""><!--[--><li><a href="#%5BCode%5D" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="[Code]">[Code]</span></a><ul class=""><!--[--><li><a href="#%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="事件函数">事件函数</span></a><!----></li><li><a href="#%E8%84%9A%E6%9C%AC%E5%B8%B8%E9%87%8F" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="脚本常量">脚本常量</span></a><!----></li><li><a href="#Check%20%E5%8F%82%E6%95%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Check 参数">Check 参数</span></a><!----></li><li><a href="#BeforeInstall%20%26%20AfterInstall%20%E5%8F%82%E6%95%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="BeforeInstall &amp; AfterInstall 参数">BeforeInstall &amp; AfterInstall 参数</span></a><!----></li><li><a href="#%E8%B0%83%E7%94%A8%20DLLs%20%E5%92%8C%20.Net%20%E7%A8%8B%E5%BA%8F%E9%9B%86" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="调用 DLLs 和 .Net 程序集">调用 DLLs 和 .Net 程序集</span></a><!----></li><li><a href="#%E4%BD%BF%E7%94%A8%20COM%20Automation%20Objects" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:12px;margin-right:16px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="使用 COM Automation Objects">使用 COM Automation Objects</span></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="#%E7%BB%93%E8%AF%AD" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="结语">结语</span></a><!----></li><!--]--></ul></nav></aside></div><hr class="border-border mt-10" data-v-1dc8ddbb=""><div class="mt-10" data-v-1dc8ddbb=""><div data-v-1dc8ddbb=""><h2 class="text-xl font-bold mb-5"><a href="#comment" class="text-accent foreground-link">留言板</a></h2><div class="utterances-wrapper"></div></div></div><!--]--></main><footer class="text-center py-6 text-gray-500 dark:text-gray-400 text-sm"><div><span>© 2017-2025 Daief's Blog</span></div></footer><div></div></div><!--]--></div>
<script>window.__INITIAL_STATE__="{\"naiveUiStyles\":\"\"}"</script>
  

</body></html>