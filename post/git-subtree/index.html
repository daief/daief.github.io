<!DOCTYPE html><html ssthtmlattrs="" lang="en"><head>
    <title>Git Subtree 的使用 | Daief's Blog</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--ssr-head-partial-->
    <script>
      if (/MSIE \d|Trident.*rv:/.test(navigator.userAgent)) {
        // redirect IE to Edge
        // This browser is no longer supported
        window.location.href = 'microsoft-edge:' + window.location.href;
        alert('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
        throw new Error('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
      }
    </script>
    <script type="module" crossorigin="" src="/assets/app-DvX1Smg_.js"></script>
    <link rel="stylesheet" crossorigin="" href="/assets/app-lBf8QYnm.css">
  <link rel="modulepreload" crossorigin="" href="/assets/vm__post_git-subtree_-BQzR7Qzd.js"><link rel="stylesheet" href="/assets/vm__post_git-subtree_-C5rAXSkw.css"><link rel="modulepreload" crossorigin="" href="/assets/meta-info-C-tMy3g2.js"><link rel="modulepreload" crossorigin="" href="/assets/toc-DNILfFl5.js"><link rel="stylesheet" href="/assets/toc-m8VwwUnR.css"><meta name="description" content=""><meta property="og:title" content="Git Subtree 的使用 | Daief's Blog"><meta property="og:description" content=""><meta property="og:image" content="https://avatars.githubusercontent.com/u/19222089?v=4"><meta name="author" content="daief"></head>
  <body ssrbodyattrs="">
    <div class="page-bg-gradient pointer-events-none fixed start-0 top-0 z-[-1] h-screen w-full"></div>
    <div id="app" data-server-rendered="true"><!--[--><div class="flex flex-col min-h-screen transition-colors duration-300"><header data-v-c69b61b1=""><div id="nav-container" class="max-w-app mx-auto text-foreground sm:bg-transparent" data-v-c69b61b1=""><div id="top-nav-wrap" class="relative grid grid-cols-2 auto-rows-auto w-full items-center justify-between p-4 sm:py-6 sm:flex sm:grid-rows-1" data-v-c69b61b1=""><a href="/" class="py-1 text-xl leading-8 font-semibold whitespace-nowrap sm:my-auto sm:text-2xl sm:leading-none" data-v-c69b61b1=""><!--[-->Daief's Blog<!--]--></a><div class="flex-center justify-end space-x-4 sm:hidden" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button><a role="button" class="text-2xl p-1" data-v-c69b61b1=""><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-c69b61b1=""><path fill="currentColor" d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></a></div><nav id="nav-menu" class="col-start-1 col-end-3 w-full flex-col items-center static top-full left-0 right-0 z-10 mt-4 sm:mt-0 sm:ms-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0 sm:flex hidden" data-v-c69b61b1=""><ul id="menu-items" class="w-full place-content-center gap-2 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0" data-v-c69b61b1=""><!--[--><li class="col-span-2" data-v-c69b61b1=""><a href="/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1 nav-active" data-v-c69b61b1=""><!--[-->文章<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/tags/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->标签<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/about/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->关于<!--]--></a></li><!--]--><li class="col-span-1 hidden sm:block" data-v-c69b61b1=""><a class="flex justify-center items-center h-full px-4 py-3 sm:px-2 sm:py-1" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button></a></li></ul></nav></div></div><div class="mx-auto max-w-app px-4" data-v-c69b61b1=""><hr class="border-border" aria-hidden="true" data-v-c69b61b1=""></div></header><main class="flex-grow max-w-app mx-auto px-4 py-8 w-full text-foreground"><!--[--><div class="relative" data-v-f1375485=""><article data-v-f1375485=""><header data-v-f1375485=""><h1 class="text-foreground text-3xl font-bold mb-4" data-v-f1375485=""> Git Subtree 的使用 </h1><div class="flex items-center gap-x-3.5 gap-y-0.5 text-foreground opacity-80 flex-wrap" data-v-f1375485=""><!--[--><!--[--><div class="inline-flex items-center gap-x-0.5 whitespace-nowrap"><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="M7 11h2v2H7zm14-6v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2M5 7h14V5H5zm14 12V9H5v10zm-4-6v-2h2v2zm-4 0v-2h2v2zm-4 2h2v2H7zm8 2v-2h2v2zm-4 0v-2h2v2z"></path></svg><span>发表于：<time datetime="2021-08-15T21:07:02.000Z">2021/08/15</time></span></div><!--[--><a href="/tags/Git/1/" class="inline-flex items-center foreground-link"><svg class="iconify-svg block select-none mr-0.5 text-foreground" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="m5.41 21l.71-4h-4l.35-2h4l1.06-6h-4l.35-2h4l.71-4h2l-.71 4h6l.71-4h2l-.71 4h4l-.35 2h-4l-1.06 6h4l-.35 2h-4l-.71 4h-2l.71-4h-6l-.71 4zM9.53 9l-1.06 6h6l1.06-6z"></path></svg>Git</a><!--]--><!--]--><!--]--></div></header><div class="md-prose max-w-none dark:prose-invert mt-6" data-v-f1375485=""><!--[--><p data-v-f1375485="">git 的 <code data-v-f1375485="">subtree</code> 是一种复用源代码的方式，可以让多个仓库引用某个仓库的代码，也可以将仓库中的某个目录拆分成一个子仓库以供其他仓库使用。</p><p data-v-f1375485="">相较于 git 的 <code data-v-f1375485="">submodule</code>，目前社区中多更推崇 subtree，自己在使用了一段时间后总体也是认为 subtree 会更好用一些。</p><p data-v-f1375485="">但同时，两者都有各自的一些问题，而 subtree 的问题目前有其他方式规避，整体用起来比较流畅，所以最终选择了 subtree。</p><blockquote data-v-f1375485=""><p data-v-f1375485="">实际上 subtree 命令需要在某个版本的 git 之后才被支持，但目前 git 的常用版本是完全足够的，所以也没去深究过。</p></blockquote><a id="more" href="#more" class="block" data-v-f1375485=""></a><h2 id="%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" data-v-f1375485="">为什么？<a name="%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" class="headerlink" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" data-v-f1375485=""></a></h2><p data-v-f1375485="">在前端领域都有 npm 了，即使不想去做 npm 包的版本管理，也还有 script 直接引入的方式，为何还需要折腾 subtree 或是 submodule？</p><p data-v-f1375485="">首先需要认清的是，subtree 并不是为了取代已有的一些模式，而是为了弥补上述方式不能很好解决的一些场景。</p><p data-v-f1375485="">假设所在的业务线上，有两个产品 α、β，分别由两个仓库 A、B 维护，两个产品背后的业务逻辑有诸多相似，会存在一些共同的业务组件、方法或是更大的功能模块，同时这些内容可能会需要快速、同步地迭代。</p><p data-v-f1375485="">虽说这样的场景可能会比较少，但确实是我最近的处境。在此之前最初的解决方式就是拷贝，简单而直接；再后来迭代更新地多了，就蛋疼了，于是转成 npm 包的方式，好歹不再复制粘贴了；过了一段时间，又厌烦了，写业务代码的时候，需要把逻辑拆到另一个包里，还得去维护 npm 包的版本，完了依赖方得进行相应地升级，开发体验还是不流畅，往往最终又回归拷贝。</p><p data-v-f1375485="">想要表达的是，实际开发中会存在一些或零碎、或具备特定业务的特性、或需要快速更迭的内容，如何用合理的方式去复用，如何能保持开发的流畅性，如何尽可能多地解决问题，这些是现在所思考的问题。</p><blockquote data-v-f1375485=""><p data-v-f1375485="">想起来这样的一个场景应该会是更常见，也是比较适合使用 subtree：原本一直在某个仓库上开发，时间久了自然会有一些仓库的沉淀（方法、组件），偶然有一天组里立项了一个新的项目，建了一个新的仓库，对于一个全新的仓库，你想使用之前的沉淀，这个时候该怎么办呢？（现实中遇到这种问题往往是通过拷贝，在多个仓库中能见到完全一样的代码，说明这种场景的代码复用实际上算是一个问题）</p></blockquote><p data-v-f1375485="">现在，私以为通过 subtree 能较好地解决上述的问题。</p><h2 id="Subtree%20%E7%9A%84%E4%BD%BF%E7%94%A8" data-v-f1375485="">Subtree 的使用<a name="Subtree%20%E7%9A%84%E4%BD%BF%E7%94%A8" class="headerlink" href="#Subtree%20%E7%9A%84%E4%BD%BF%E7%94%A8" data-v-f1375485=""></a></h2><p data-v-f1375485="">如何在已有仓库中引用另一个仓库，例如想要在 repo-a 中引用 sub-repo，且假定仓库的信息如下：</p><ul data-v-f1375485=""><li data-v-f1375485="">repo-a：<a href="http://example.com/repo-a.git" target="_blank" class="" data-v-f1375485=""><!--[-->http://example.com/repo-a.git<!--]--></a></li><li data-v-f1375485="">sub-repo：<a href="http://example.com/sub-repo.git" target="_blank" class="" data-v-f1375485=""><!--[-->http://example.com/sub-repo.git<!--]--></a></li></ul><h3 id="%E6%B7%BB%E5%8A%A0" data-v-f1375485="">添加<a name="%E6%B7%BB%E5%8A%A0" class="headerlink" href="#%E6%B7%BB%E5%8A%A0" data-v-f1375485=""></a></h3><p data-v-f1375485="">首先需要在 repo-a 中添加子仓库 sub-repo，该命令只需在首次执行：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f1375485=""><code data-v-f1375485=""><span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> cd</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> repo-a</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> add</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --prefix=subtrees/sub-repo</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> http://example.com/sub-repo.git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> master</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f1375485=""># 可以添加 squash 参数压缩自仓库的提交</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> add</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --prefix=subtrees/sub-repo</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> http://example.com/sub-repo.git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> master</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --squash</span></span></code></pre><p data-v-f1375485="">该命令表示将 <code data-v-f1375485="">http://example.com/sub-repo.git</code> 仓库 <code data-v-f1375485="">master</code> 分支的内容添加到 <code data-v-f1375485="">repo-a</code> 仓库的 <code data-v-f1375485="">subtrees/sub-repo</code> 目录。</p><p data-v-f1375485="">subtree 的一个好处开始体现了，对于 <code data-v-f1375485="">repo-a</code> 的 <code data-v-f1375485="">subtrees/sub-repo</code> 目录，在日常使用中不需要特殊对待，它就是一个普通的目录，可以正常修改其中的内容、正常提交、正常地切分支、回滚或是 revert 等等。</p><h3 id="%E6%8B%89%E5%8F%96%E6%9B%B4%E6%96%B0%20subtree" data-v-f1375485="">拉取更新 subtree<a name="%E6%8B%89%E5%8F%96%E6%9B%B4%E6%96%B0%20subtree" class="headerlink" href="#%E6%8B%89%E5%8F%96%E6%9B%B4%E6%96%B0%20subtree" data-v-f1375485=""></a></h3><p data-v-f1375485="">当需要拉取子仓库的内容时，需要使用 <code data-v-f1375485="">git subtree pull</code> 命令：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f1375485=""><code data-v-f1375485=""><span class="line" data-v-f1375485=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f1375485=""># 同样支持 squash 参数</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> pull</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --prefix=subtrees/sub-repo</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> http://example.com/sub-repo.git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> master</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --squash</span></span></code></pre><p data-v-f1375485="">该命令会将远端 <code data-v-f1375485="">http://example.com/sub-repo.git</code> 仓库 <code data-v-f1375485="">master</code> 分支的内容同步到当前 <code data-v-f1375485="">repo-a</code> 仓库的 <code data-v-f1375485="">subtrees/sub-repo</code> 目录。</p><h3 id="%E5%88%A0%E9%99%A4%E5%AD%90%E4%BB%93%E5%BA%93" data-v-f1375485="">删除子仓库<a name="%E5%88%A0%E9%99%A4%E5%AD%90%E4%BB%93%E5%BA%93" class="headerlink" href="#%E5%88%A0%E9%99%A4%E5%AD%90%E4%BB%93%E5%BA%93" data-v-f1375485=""></a></h3><p data-v-f1375485="">直接删除 <code data-v-f1375485="">subtrees/sub-repo</code> 目录，将删除操作提交。</p><h3 id="%E6%8E%A8%E9%80%81%E6%9C%AC%E5%9C%B0%E5%AF%B9%E5%AD%90%E4%BB%93%E5%BA%93%E7%9A%84%E6%9B%B4%E6%96%B0" data-v-f1375485="">推送本地对子仓库的更新<a name="%E6%8E%A8%E9%80%81%E6%9C%AC%E5%9C%B0%E5%AF%B9%E5%AD%90%E4%BB%93%E5%BA%93%E7%9A%84%E6%9B%B4%E6%96%B0" class="headerlink" href="#%E6%8E%A8%E9%80%81%E6%9C%AC%E5%9C%B0%E5%AF%B9%E5%AD%90%E4%BB%93%E5%BA%93%E7%9A%84%E6%9B%B4%E6%96%B0" data-v-f1375485=""></a></h3><p data-v-f1375485="">subtree 也提供了原生的推送命令，但我个人并不推荐直接使用，不过还是得先记录下原生的用法。</p><p data-v-f1375485="">当需要将本地 <code data-v-f1375485="">subtrees/sub-repo</code> 的更新推送到源仓库的时候，可以使用 push 命令：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f1375485=""><code data-v-f1375485=""><span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> push</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --prefix=subtrees/sub-repo</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> http://example.com/sub-repo.git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> master</span></span></code></pre><p data-v-f1375485="">该命令会将本地仓库 <code data-v-f1375485="">subtrees/sub-repo</code> 目录下的内容推送到 <code data-v-f1375485="">http://example.com/sub-repo.git</code> 的 <code data-v-f1375485="">master</code> 分支。</p><p data-v-f1375485=""><strong data-v-f1375485="">当执行 <code data-v-f1375485="">git subtree push</code> 的时候，git 会去遍历当前所有的 commit，计算出其中对 <code data-v-f1375485="">subtrees/sub-repo</code> 目录的修改，再将这些 commit 推送到子仓库去</strong>。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f1375485=""><code data-v-f1375485=""><span class="line" data-v-f1375485=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f1375485=""># 上述命令的输出，该仓库有 1470 个提交</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">1451/</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f1375485="">  1470</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> (1450) [19]</span></span></code></pre><p data-v-f1375485="">除了这个一千多提交的仓库，另一个我实际在日常迭代的仓库已达到了三千多的提交，这导致在 push 子仓库的时候就很痛苦，每次 push 都需要耗费大量时间来计算提交。</p><p data-v-f1375485="">像这种三千多提交的大仓库，git 在执行计算的时候还可能因为性能问题直接抛出异常中断操作，原因可能是内存超过了操作系统给到这个程序的内存空间。该异常的错误信息常带有 <code data-v-f1375485="">Segmentation fault: 11</code> 字样。</p><p data-v-f1375485="">总之，我对 subtree 原生的 push 命令是拒绝的。为了解决推送的问题，我选择自定义脚本的方式去实现，过程就是每次推送的时候进入子目录，初始化一个临时的仓库，将子目录的仓库进行提交并推送即可，脚本的大概内容如下：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f1375485=""><code data-v-f1375485=""><span class="line" data-v-f1375485=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f1375485="">// subtrees/sub-repo/scripts/push.js</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> path</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> require</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">path</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> fs</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> require</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">fs</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485=""> {</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> exec</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485=""> }</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> require</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">child_process</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> dayjs</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> require</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">dayjs</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> baseRoot</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485=""> path</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">resolve</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">__dirname</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f1375485="">,</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">..</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> baseGit</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485=""> path</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">resolve</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">baseRoot</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f1375485="">,</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">.git</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> hasGit</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f1375485="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485=""> {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">  try</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485=""> {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">    return</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485=""> fs</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">statSync</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">baseGit</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">)</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">isDirectory</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485="">;</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485="">  }</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485=""> catch</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">error</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485=""> {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">    return</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FF5874;--shiki-dark-font-style:italic;" data-v-f1375485=""> false</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485="">;</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485="">  }</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f1375485="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">)();</span></span>
<span class="line" data-v-f1375485=""></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> now</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> dayjs</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">();</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> branchName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485=""> `</span><span style="--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#ECC48D;--shiki-dark-font-style:italic;" data-v-f1375485="">script/</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">${</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">now</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">format</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">YYYY-MM-DD_HH_mm</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">}</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">;</span></span>
<span class="line" data-v-f1375485=""></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485=""> commands</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> [</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f1375485="">  ...</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">hasGit</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">    ?</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> []</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">    :</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> [</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">        '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">git init</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">        '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">git remote add origin http://example.com/sub-repo.git</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">        `</span><span style="--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#ECC48D;--shiki-dark-font-style:italic;" data-v-f1375485="">git checkout -b </span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">${</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">branchName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">}</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">`</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">      ])</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">  '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">git add .</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">  `</span><span style="--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#ECC48D;--shiki-dark-font-style:italic;" data-v-f1375485="">git commit -m "script: </span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">${</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">now</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">format</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">YYYY-MM-DD HH:mm:ss</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">}</span><span style="--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#ECC48D;--shiki-dark-font-style:italic;" data-v-f1375485="">" -n</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">`</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">  '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">git pull origin master --allow-unrelated-histories</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">  `</span><span style="--shiki-light:#22863A;--shiki-light-font-style:inherit;--shiki-dark:#ECC48D;--shiki-dark-font-style:italic;" data-v-f1375485="">git push origin HEAD:</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">${</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">branchName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">}</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">`</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">];</span></span>
<span class="line" data-v-f1375485=""></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">exec</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">  commands</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">join</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485=""> &amp;&amp; </span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">)</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">  {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">    cwd</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f1375485="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485=""> baseRoot</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">  }</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f1375485="">  (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">error</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485=""> stdout</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485=""> stderr</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f1375485="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">error</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">) {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">      console</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">error</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">error</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">      console</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">Error:</span><span style="--shiki-light:#22863A;--shiki-dark:#F78C6C;" data-v-f1375485="">\n</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485=""> stderr</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">    } </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f1375485="">else</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485=""> {</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">      console</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">stdout</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic;" data-v-f1375485="">      console</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f1375485="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#22863A;--shiki-dark:#F78C6C;" data-v-f1375485="">\n</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f1375485="">'</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485=""> stderr</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">      exec</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">(</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">`</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f1375485="">rm -r </span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">${</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f1375485="">baseGit</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D3423E;" data-v-f1375485="">}</span><span style="--shiki-light:#22863A;--shiki-dark:#D6DEEB;" data-v-f1375485="">`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">    }</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">  }</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f1375485="">,</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f1375485="">);</span></span></code></pre><p data-v-f1375485="">这样一来，需要 push 的时候只需执行 <code data-v-f1375485="">node subtrees/sub-repo/scripts/push.js</code>，完成之后会在远端新建一个临时分支，真正合并的时候在 gitlab 或 github 提交 MR 即可，这样一来子仓库的改动也能经过团队的评审。</p><p data-v-f1375485="">push 的脚本里会自动拉取同步一下 master 分支，可能会出现冲突的情况，此时只需在本地解决冲突，进行提交，再次执行 <code data-v-f1375485="">push.js</code> 脚本即可。</p><p data-v-f1375485="">使用这种推送方式，就不再有上述“遍历 commit”的问题，心情都舒畅了。不过这种方式会导致子仓库的提交信息被丢失，但实际上问题不大，因为主仓库中会包含子仓库的相关文件的改动。</p><h3 id="%E4%BB%8E%E5%BD%93%E5%89%8D%E4%BB%93%E5%BA%93%E6%8B%86%E5%88%86%E5%87%BA%E5%AD%90%E4%BB%93%E5%BA%93" data-v-f1375485="">从当前仓库拆分出子仓库<a name="%E4%BB%8E%E5%BD%93%E5%89%8D%E4%BB%93%E5%BA%93%E6%8B%86%E5%88%86%E5%87%BA%E5%AD%90%E4%BB%93%E5%BA%93" class="headerlink" href="#%E4%BB%8E%E5%BD%93%E5%89%8D%E4%BB%93%E5%BA%93%E6%8B%86%E5%88%86%E5%87%BA%E5%AD%90%E4%BB%93%E5%BA%93" data-v-f1375485=""></a></h3><p data-v-f1375485="">另一种情况是需要在一个已有的主仓库中拆离出一个子仓库，此时可以使用 <code data-v-f1375485="">git subtree split</code>：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f1375485=""><code data-v-f1375485=""><span class="line" data-v-f1375485=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f1375485=""># 先执行 split 生成临时分支 subtree/split-tmp</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> split</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --prefix=subtrees/sub-repo</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --rejoin</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF;" data-v-f1375485=""> --branch</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree/split-tmp</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f1375485=""># 再将临时分支 subtree/split-tmp 推送到子仓库的 master</span></span>
<span class="line" data-v-f1375485=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f1375485="">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> push</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> http://example.com/sub-repo.git</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D;" data-v-f1375485=""> subtree/split-tmp:master</span></span></code></pre><p data-v-f1375485="">命令 <code data-v-f1375485="">git subtree split</code> 相当于将目录拆分为独立的分支，即子树拆分。拆分后形成的分支可以通过推送到新的版本库实现原版本库的目录独立为一个新的版本库。</p><h2 id="%E7%BB%93%E8%AF%AD" data-v-f1375485="">结语<a name="%E7%BB%93%E8%AF%AD" class="headerlink" href="#%E7%BB%93%E8%AF%AD" data-v-f1375485=""></a></h2><p data-v-f1375485="">submodule 我也简单使用过，它和 subtree 很大的不同就是在一个项目中会同时存在多个 git 仓库，在使用的过程中需要要关心改动是在父仓库、还是在子仓库。而 subtree 除了在与子仓库交互的时候（add、pull、push），其他情况完全可以抛弃 subtree 的概念，所谓子仓库就是仓库中的一个目录，对于切分支、回滚等操作都很友好，推送的问题也能使用简单的方式进行规避，所以我也更推崇 subtree。</p><p data-v-f1375485="">参考资料：</p><ul data-v-f1375485=""><li data-v-f1375485=""><a href="https://juejin.cn/post/6881580754854215687" target="_blank" class="" data-v-f1375485=""><!--[-->Git subtree 用法与常见问题分析<!--]--></a></li><li data-v-f1375485=""><a href="https://juejin.cn/post/6936459179049615397" target="_blank" class="" data-v-f1375485=""><!--[-->Git SubTree 使用<!--]--></a></li><li data-v-f1375485=""><a href="https://tech.youzan.com/git-subtree/" target="_blank" class="" data-v-f1375485=""><!--[-->用 Git Subtree 在多个 Git 项目间双向同步子项目，附简明使用手册<!--]--></a></li><li data-v-f1375485=""><a href="https://www.worldhello.net/gotgit/04-git-model/050-subtree-model.html#git-subtree-split" target="_blank" class="" data-v-f1375485=""><!--[-->4.5 子树合并<!--]--></a></li></ul><!--]--></div></article><aside class="pointer-events-none fixed z-20 top-0 w-full h-full left-0 overscroll-contain transition-300 lg:pointer-events-auto lg:absolute lg:w-auto lg:bg-transparent lg:left-[calc(100%+clamp(6px,17.1875vw-176px,50px))]" data-v-f1375485=""><nav class="overflow-y-auto text-foreground overscroll-contain bg-background w-74 max-w-4/5 h-full py-8 px-6 rounded-tl-xl rounded-bl-xl absolute top-0 transition-300 right-0 translate-x-full lg:p-0 lg:max-w-44 xl:max-w-50 lg:h-auto lg:max-h-[calc(100vh-130px)] lg:rounded-none lg:sticky lg:top-10 lg:right-auto lg:translate-x-0 lg:bg-transparent lg:ml-0" data-v-f1375485=""><h2 class="mb-2 font-bold lg:hidden" data-v-f1375485="">TABLE OF CONTENTS</h2><ul class="group/root" data-v-f1375485=""><!--[--><li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="为什么？">为什么？</span></a><!----></li><li><a href="#Subtree%20%E7%9A%84%E4%BD%BF%E7%94%A8" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="Subtree 的使用">Subtree 的使用</span></a><ul class=""><!--[--><li><a href="#%E6%B7%BB%E5%8A%A0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="添加">添加</span></a><!----></li><li><a href="#%E6%8B%89%E5%8F%96%E6%9B%B4%E6%96%B0%20subtree" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="拉取更新 subtree">拉取更新 subtree</span></a><!----></li><li><a href="#%E5%88%A0%E9%99%A4%E5%AD%90%E4%BB%93%E5%BA%93" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="删除子仓库">删除子仓库</span></a><!----></li><li><a href="#%E6%8E%A8%E9%80%81%E6%9C%AC%E5%9C%B0%E5%AF%B9%E5%AD%90%E4%BB%93%E5%BA%93%E7%9A%84%E6%9B%B4%E6%96%B0" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="推送本地对子仓库的更新">推送本地对子仓库的更新</span></a><!----></li><li><a href="#%E4%BB%8E%E5%BD%93%E5%89%8D%E4%BB%93%E5%BA%93%E6%8B%86%E5%88%86%E5%87%BA%E5%AD%90%E4%BB%93%E5%BA%93" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:16px;margin-right:12px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="从当前仓库拆分出子仓库">从当前仓库拆分出子仓库</span></a><!----></li><!--]--></ul></li><li><a href="#%E7%BB%93%E8%AF%AD" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="结语">结语</span></a><!----></li><!--]--></ul></nav></aside></div><hr class="border-border mt-10" data-v-f1375485=""><div class="mt-10" data-v-f1375485=""><div data-v-f1375485=""><h2 class="text-xl font-bold mb-5"><a href="#comment" class="text-accent foreground-link">留言板</a></h2><div class="utterances-wrapper"></div></div></div><!--]--></main><footer class="text-center py-6 text-gray-500 dark:text-gray-400 text-sm"><div><span>© 2017-2025 Daief's Blog</span></div></footer><div></div></div><!--]--></div>
<script>window.__INITIAL_STATE__="{\"naiveUiStyles\":\"\"}"</script>
  

</body></html>