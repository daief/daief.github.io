<!DOCTYPE html><html ssthtmlattrs="" lang="en"><head>
    <title>基于 React Hooks 的小型状态管理 | Daief's Blog</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--ssr-head-partial-->
    <script>
      if (/MSIE \d|Trident.*rv:/.test(navigator.userAgent)) {
        // redirect IE to Edge
        // This browser is no longer supported
        window.location.href = 'microsoft-edge:' + window.location.href;
        alert('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
        throw new Error('请使用 Chrome/Edge/Firefox/Safari 等现代浏览器。');
      }
    </script>
    <script type="module" crossorigin="" src="/assets/app-DvX1Smg_.js"></script>
    <link rel="stylesheet" crossorigin="" href="/assets/app-lBf8QYnm.css">
  <link rel="modulepreload" crossorigin="" href="/assets/vm__post_react-state-management-based-on-react-hooks_-CuZAQ7kR.js"><link rel="stylesheet" href="/assets/vm__post_react-state-management-based-on-react-hooks_-Dmm6BxJN.css"><link rel="modulepreload" crossorigin="" href="/assets/meta-info-C-tMy3g2.js"><link rel="modulepreload" crossorigin="" href="/assets/toc-DNILfFl5.js"><link rel="stylesheet" href="/assets/toc-m8VwwUnR.css"><meta name="description" content=""><meta property="og:title" content="基于 React Hooks 的小型状态管理 | Daief's Blog"><meta property="og:description" content=""><meta property="og:image" content="https://avatars.githubusercontent.com/u/19222089?v=4"><meta name="author" content="daief"></head>
  <body ssrbodyattrs="">
    <div class="page-bg-gradient pointer-events-none fixed start-0 top-0 z-[-1] h-screen w-full"></div>
    <div id="app" data-server-rendered="true"><!--[--><div class="flex flex-col min-h-screen transition-colors duration-300"><header data-v-c69b61b1=""><div id="nav-container" class="max-w-app mx-auto text-foreground sm:bg-transparent" data-v-c69b61b1=""><div id="top-nav-wrap" class="relative grid grid-cols-2 auto-rows-auto w-full items-center justify-between p-4 sm:py-6 sm:flex sm:grid-rows-1" data-v-c69b61b1=""><a href="/" class="py-1 text-xl leading-8 font-semibold whitespace-nowrap sm:my-auto sm:text-2xl sm:leading-none" data-v-c69b61b1=""><!--[-->Daief's Blog<!--]--></a><div class="flex-center justify-end space-x-4 sm:hidden" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button><a role="button" class="text-2xl p-1" data-v-c69b61b1=""><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em" data-v-c69b61b1=""><path fill="currentColor" d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></a></div><nav id="nav-menu" class="col-start-1 col-end-3 w-full flex-col items-center static top-full left-0 right-0 z-10 mt-4 sm:mt-0 sm:ms-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0 sm:flex hidden" data-v-c69b61b1=""><ul id="menu-items" class="w-full place-content-center gap-2 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0" data-v-c69b61b1=""><!--[--><li class="col-span-2" data-v-c69b61b1=""><a href="/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1 nav-active" data-v-c69b61b1=""><!--[-->文章<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/tags/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->标签<!--]--></a></li><li class="col-span-2" data-v-c69b61b1=""><a href="/about/" class="flex justify-center items-center h-full px-4 py-3 font-medium hover:text-accent sm:px-2 sm:py-1" data-v-c69b61b1=""><!--[-->关于<!--]--></a></li><!--]--><li class="col-span-1 hidden sm:block" data-v-c69b61b1=""><a class="flex justify-center items-center h-full px-4 py-3 sm:px-2 sm:py-1" data-v-c69b61b1=""><button class="cursor-pointer relative" data-v-c69b61b1=""><div class="w-10 h-6 rounded-3xl border-[3px] border-[#d1d5da] transition-300 dark:border-[#6E40C9]"><div class="absolute top-1/2 -left-0.5 transform -translate-y-1/2 transition-300 w-[28px] h-[28px] bg-[#2f363d] rounded-full flex-center dark:bg-[#6E40C9] dark:left-[calc(100%-28px+2px)]"><span class="text-[16px]"><!--?xml version="1.0" standalone="no"?-->
<svg t="1761650889094" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2362" xmlns:xlink="http://www.w3.org/1999/xlink" width="1em" height="1em">
  <path d="M554.632 298.914h-85.264c-11.782 0-21.344-9.546-21.344-21.328s9.562-21.328 21.344-21.328h85.264c11.81 0 21.374 9.546 21.374 21.328s-9.562 21.328-21.374 21.328z" fill="#F6BB42" p-id="2363"></path>
  <path d="M810.562 725.43c-282.664 0-511.812-229.164-511.812-511.826 0-63.53 11.594-124.372 32.748-180.51C137.91 106.076 0.196 293.04 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 219.102 0 406.096-137.714 479.034-331.302-56.126 21.156-116.934 32.748-180.496 32.748z" fill="#FFCE54" p-id="2364"></path>
  <path d="M554.632 981.328c-282.632 0-511.78-229.148-511.78-511.812 0-130.434 48.81-249.476 129.122-339.848C66.6 223.416 0.196 360.02 0.196 512.172c0 282.662 229.15 511.812 511.828 511.812 152.106 0 288.726-66.406 382.47-171.806-90.368 80.368-209.43 129.15-339.862 129.15z" fill="#F6BB42" p-id="2365"></path>
  <path d="M767.938 277.586c0 11.782-9.562 21.328-21.376 21.328-11.75 0-21.312-9.546-21.312-21.328s9.562-21.328 21.312-21.328c11.814 0 21.376 9.546 21.376 21.328z" fill="#4A89DC" p-id="2366"></path>
  <path d="M661.316 490.844c0 11.766-9.562 21.328-21.374 21.328-11.75 0-21.312-9.562-21.312-21.328 0-11.782 9.562-21.328 21.312-21.328 11.812 0 21.374 9.546 21.374 21.328z" fill="#48CFAD" p-id="2367"></path>
  <path d="M1023.804 234.586c0 11.782-9.562 21.328-21.312 21.328-11.748 0-21.31-9.546-21.31-21.328 0-11.78 9.562-21.326 21.31-21.326 11.75 0 21.312 9.546 21.312 21.326z" fill="#ED5564" p-id="2368"></path>
  <path d="M639.944 21.328c0 11.782-9.5 21.328-21.312 21.328-11.75 0-21.312-9.546-21.312-21.328 0-11.766 9.562-21.312 21.312-21.312a21.288 21.288 0 0 1 21.312 21.312z" fill="#AC92EB" p-id="2369"></path>
  <path d="M512.024 192.276c-11.782 0-21.344 9.562-21.344 21.328v127.964c0 11.766 9.562 21.312 21.344 21.312 11.75 0 21.312-9.546 21.312-21.312v-127.964c0-11.766-9.562-21.328-21.312-21.328z" fill="#FFCE54" p-id="2370"></path>
  <path d="M874.56 426.862c-11.812 0-21.312 9.546-21.312 21.328v127.934c0 11.812 9.5 21.344 21.312 21.344 11.748 0 21.308-9.532 21.308-21.344v-127.934c0.002-11.78-9.56-21.328-21.308-21.328z" fill="#F6BB42" p-id="2371"></path>
  <path d="M917.182 533.484h-85.306c-11.75 0-21.312-9.546-21.312-21.312 0-11.782 9.562-21.328 21.312-21.328h85.306c11.812 0 21.312 9.546 21.312 21.328 0 11.766-9.5 21.312-21.312 21.312z" fill="#FFCE54" p-id="2372"></path>
</svg>
</span></div></div></button></a></li></ul></nav></div></div><div class="mx-auto max-w-app px-4" data-v-c69b61b1=""><hr class="border-border" aria-hidden="true" data-v-c69b61b1=""></div></header><main class="flex-grow max-w-app mx-auto px-4 py-8 w-full text-foreground"><!--[--><div class="relative" data-v-f68ab365=""><article data-v-f68ab365=""><header data-v-f68ab365=""><h1 class="text-foreground text-3xl font-bold mb-4" data-v-f68ab365=""> 基于 React Hooks 的小型状态管理 </h1><div class="flex items-center gap-x-3.5 gap-y-0.5 text-foreground opacity-80 flex-wrap" data-v-f68ab365=""><!--[--><!--[--><div class="inline-flex items-center gap-x-0.5 whitespace-nowrap"><svg class="iconify-svg block" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="M7 11h2v2H7zm14-6v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2M5 7h14V5H5zm14 12V9H5v10zm-4-6v-2h2v2zm-4 0v-2h2v2zm-4 2h2v2H7zm8 2v-2h2v2zm-4 0v-2h2v2z"></path></svg><span>发表于：<time datetime="2021-12-26T18:20:42.000Z">2021/12/26</time></span></div><!--[--><a href="/tags/React/1/" class="inline-flex items-center foreground-link"><svg class="iconify-svg block select-none mr-0.5 text-foreground" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="m5.41 21l.71-4h-4l.35-2h4l1.06-6h-4l.35-2h4l.71-4h2l-.71 4h6l.71-4h2l-.71 4h4l-.35 2h-4l-1.06 6h4l-.35 2h-4l-.71 4h-2l.71-4h-6l-.71 4zM9.53 9l-1.06 6h6l1.06-6z"></path></svg>React</a><!--]--><!--]--><!--]--></div></header><div class="md-prose max-w-none dark:prose-invert mt-6" data-v-f68ab365=""><!--[--><p data-v-f68ab365="">一年又又又要过去了，在这 2021 年的尾巴，来写写 React 的状态管理。</p><p data-v-f68ab365="">本文主要介绍一种基于 React Hooks 的状态共享方案，介绍其实现，并总结一下使用感受，目的是在状态管理方面提供多一种选择方式。</p><a id="more" href="#more" class="block" data-v-f68ab365=""></a><h2 id="%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8E%20React%20Hooks%20%E7%9A%84%E7%8A%B6%E6%80%81%E5%85%B1%E4%BA%AB" data-v-f68ab365="">实现基于 React Hooks 的状态共享<a name="%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8E%20React%20Hooks%20%E7%9A%84%E7%8A%B6%E6%80%81%E5%85%B1%E4%BA%AB" class="headerlink" href="#%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8E%20React%20Hooks%20%E7%9A%84%E7%8A%B6%E6%80%81%E5%85%B1%E4%BA%AB" data-v-f68ab365=""></a></h2><p data-v-f68ab365="">React 组件间的状态共享，是一个老生常谈的问题，也有很多解决方案，例如 Redux、MobX 等。这些方案很专业，也经历了时间的考验，但私以为他们不太适合一些不算复杂的项目，反而会引入一些额外的复杂度。</p><p data-v-f68ab365="">实际上很多时候，我不想定义 mutation 和 action、我不想套一层 context，更不想写 connect 和 mapStateToProps；我想要的是一种轻量、简单的状态共享方案，简简单单引用、简简单单使用。</p><p data-v-f68ab365="">随着 Hooks 的诞生、流行，我的想法得以如愿。</p><p data-v-f68ab365="">接着介绍一下我目前在用的方案，将 Hooks 与发布/订阅模式结合，就能实现一种简单、实用的状态共享方案。因为代码不多，下面将给出完整的实现。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f68ab365=""><code data-v-f68ab365=""><span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">import</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  Dispatch</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  SetStateAction</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  useCallback</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  useEffect</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  useReducer</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  useRef</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  useState</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">} </span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">from</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">react</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">/**</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@see</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365=""> https://github.com/facebook/react/blob/bb88ce95a87934a655ef842af776c164391131ac/packages/shared/objectIs.js</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * inlined Object.is polyfill to avoid requiring consumers ship their own</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">function</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> is</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">x</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365=""> y</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> boolean</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (x </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">===</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> y </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">&amp;&amp;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (x </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!==</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 0</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ||</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 1</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> /</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> x </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">===</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 1</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> /</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> y)) </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">||</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (x </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!==</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> x </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">&amp;&amp;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> y </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!==</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> y);</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">}</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> objectIs</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> typeof</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Object</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-f68ab365="">is</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ===</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">function</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ?</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Object</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-f68ab365="">is</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> :</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> is</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">/**</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@see</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365=""> https://github.com/facebook/react/blob/933880b4544a83ce54c8a47f348effe725a58843/packages/shared/shallowEqual.js</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * Performs equality by iterating through keys on an object and returning false</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * when any key has values which are not strictly equal between the arguments.</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * Returns true when the values of all keys are strictly equal.</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">function</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> shallowEqual</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">objA</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365=""> objB</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> boolean</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">is</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(objA</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> objB)) {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> true</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  }</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    typeof</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> objA </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!==</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">object</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ||</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    objA </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">===</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> null</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ||</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    typeof</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> objB </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!==</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">object</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ||</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    objB </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">===</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> null</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  ) {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> false</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  }</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> keysA</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Object</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">keys</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">objA</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> keysB</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Object</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">keys</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">objB</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365="">keysA</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#7FDBCA;" data-v-f68ab365="">length</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> !==</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> keysB</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#7FDBCA;" data-v-f68ab365="">length</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">) {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> false</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  }</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // Test for A's keys different from B.</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  for</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">let</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> i</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">; i </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> keysA</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#7FDBCA;" data-v-f68ab365="">length</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">; i</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">++</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">) {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      !</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365="">Object</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#7FDBCA;" data-v-f68ab365="">prototype</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic;" data-v-f68ab365="">hasOwnProperty</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">call</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(objB</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> keysA[i]) </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">||</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      !</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">is</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(objA[keysA[i]]</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> objB[keysA[i]])</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    ) {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">      return</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> false</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    }</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  }</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#1976D2;--shiki-dark:#FF5874;" data-v-f68ab365=""> true</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">}</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> useForceUpdate</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> useReducer</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">{}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)[</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">1</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">]</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365=""> as</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> VoidFunction</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> ISubscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt; </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">prevState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> T</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365=""> nextState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> void</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">export</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> ISharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt; {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** 静态方式获取数据, 适合在非组件中或者数据无绑定视图的情况下使用 */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  get</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** 修改数据，赋予新值 */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  set</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> Dispatch</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">SetStateAction</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;&gt;;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** （浅）合并更新数据 */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  update</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> Dispatch</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">Partial</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;&gt;;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** hooks方式获取数据, 适合在组件中使用, 数据变更时会自动重渲染该组件 */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  use</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** 订阅数据的变更 */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  subscribe</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">cb</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> ISubscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> void</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** 取消订阅数据的变更 */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  unsubscribe</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">cb</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> ISubscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> void</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  /** 筛出部分 state */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  usePick</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">R</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">picker</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">state</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> R</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365=""> deps</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">?:</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365=""> readonly</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">[]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> R</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">}</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">export</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> IReadonlyState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt; </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> Omit</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">ISharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">set</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> |</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">update</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">/**</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * 创建不同实例之间可以共享的状态</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@param</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#78CCF0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> initialState</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> 初始数据</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">export</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createSharedState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">initialState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ISharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  let</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> state</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> initialState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> subscribers</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ISubscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">[]</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> []</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 订阅 state 的变化</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> subscribe</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">subscriber</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ISubscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    subscribers</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">push</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">subscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> unsubscribe</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">subscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 取消订阅 state 的变化</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> unsubscribe</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">subscriber</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ISubscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> index</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> subscribers</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">indexOf</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">subscriber</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    index</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> &gt;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> -</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">1</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> &amp;&amp;</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> subscribers</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">splice</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">index</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 1</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 获取当前最新的 state</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> get</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 变更 state</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> set</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">next</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> SetStateAction</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> prevState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">    // @ts-ignore</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> nextState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> typeof</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> next</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ===</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">function</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ?</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> next</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">prevState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> :</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> next</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">objectIs</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">state</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> nextState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">))</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">      return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    state</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> nextState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    subscribers</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">forEach</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">cb</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> cb</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">prevState</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">))</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 获取当前最新的 state 的 hooks 用法</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> use</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> forceUpdate</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> useForceUpdate</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">    useEffect</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      let</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> isMounted</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FF5874;--shiki-dark-font-style:italic;" data-v-f68ab365=""> true</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">      // 组件挂载后立即更新一次, 避免无法使用到第一次更新数据</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">      forceUpdate</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> un</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> subscribe</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">        if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">isMounted</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365=""> return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">        forceUpdate</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">      }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">      return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">        un</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">        isMounted</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FF5874;--shiki-dark-font-style:italic;" data-v-f68ab365=""> false</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">      };</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> [])</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> usePick</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">R</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">picker</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">s</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> R</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> deps</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> []</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ref</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> useRef</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365="">any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">{}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    ref</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic;" data-v-f68ab365="">current</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-f68ab365="">picker</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> picker</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> [</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">pickedState</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> setPickedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">]</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> useState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">R</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">      ref</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic;" data-v-f68ab365="">current</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">picker</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    ref</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic;" data-v-f68ab365="">current</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-f68ab365="">oldState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> pickedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">    const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> sub</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> useCallback</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> pickedOld</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ref</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic;" data-v-f68ab365="">current</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-f68ab365="">oldState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> pickedNew</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> ref</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic;" data-v-f68ab365="">current</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">picker</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">!</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">shallowEqual</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">pickedOld</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> pickedNew</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">))</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">        // 避免 pickedNew 是一个 function</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">        setPickedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> pickedNew</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">      }</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> [])</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">    useEffect</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> un</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> subscribe</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">sub</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">      return</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> un</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> [])</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">    useEffect</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">      sub</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> [</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">...</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">deps</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">])</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> pickedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    get</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    set</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">    update</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">input</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Partial</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">      set</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">pre</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">{</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">        ...</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">pre</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">        ...</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">input</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">      }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">))</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    use</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    subscribe</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    unsubscribe</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">    usePick</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span></code></pre><p data-v-f68ab365="">拥有 <code data-v-f68ab365="">createSharedState</code> 之后，下一步就能轻易地创建出一个可共享的状态了，在组件中使用的方式也很直接。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f68ab365=""><code data-v-f68ab365=""><span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">// 创建一个状态实例</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> countState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createSharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> A</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 在组件中使用 hooks 方式获取响应式数据</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> count</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> countState</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">use</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">A: </span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">{</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">count</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> B</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // 使用 set 方法修改数据</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">button</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365=""> onClick</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">{</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> countState</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">set</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(count</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> +</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 1</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">Add</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">button</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> C</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">button</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365="">      onClick</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">{</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">        // 使用 get 方法获取数据</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365="">        console</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365="">countState</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">get</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">())</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">      }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">}</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    &gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">      Get</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">button</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> App</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    &lt;&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">      &lt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">A</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> /&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">      &lt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">B</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> /&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">      &lt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">C</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> /&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    &lt;/&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span></code></pre><p data-v-f68ab365="">对于复杂对象，还提供了一种方式，用于在组件中监听指定部分的数据变化，避免其他字段变更造成多余的 render：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f68ab365=""><code data-v-f68ab365=""><span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> complexState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createSharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">{</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  a</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 0</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  b</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    c</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 0</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> A</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> a</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> complexState</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">usePick</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">state</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> state</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#BAEBE2;--shiki-dark-font-style:italic;" data-v-f68ab365="">a</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">A: </span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">{</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">a</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span></code></pre><p data-v-f68ab365="">但复杂对象一般更建议使用组合派生的方式，由多个简单的状态派生出一个复杂的对象。另外在有些时候，我们会需要一种基于原数据的计算结果，所以这里同时提供了一种派生数据的方式。</p><p data-v-f68ab365="">通过显示声明依赖的方式监听数据源，再传入计算函数，那么就能得到一个响应式的派生结果了。</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f68ab365=""><code data-v-f68ab365=""><span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">/**</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * 状态派生（或 computed）</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * ```ts</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * const count1 = createSharedState(1);</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * const count2 = createSharedState(2);</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * const count3 = createDerivedState([count1, count2], ([n1, n2]) =&gt; n1 + n2);</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * ```</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@param</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#78CCF0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> stores</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@param</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#78CCF0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> fn</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@param</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#78CCF0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> initialValue</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@returns</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365=""> */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">export</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> function</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createDerivedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">  stores</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> IReadonlyState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365="">any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt;[]</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  fn</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">values</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">[]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> T</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">  opts</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">?:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">    /**</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">     * 是否同步响应</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">     * </span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">@default</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#78CCF0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> false</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">     */</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    sync</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">?:</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> boolean</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  }</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365=""> IReadonlyState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB8B;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">&gt; </span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&amp;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  stop</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478;" data-v-f68ab365=""> void</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">} {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> sync</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> }</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365=""> sync</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FF5874;--shiki-dark-font-style:italic;" data-v-f68ab365=""> false</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> ...</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">opts</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  let</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> values</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365=""> any</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">[]</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> stores</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">map</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">it</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> it</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">get</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">());</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> innerModel</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createSharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365="">T</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">fn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">values</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">));</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  let</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> promise</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#FFCB8B;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Promise</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&lt;</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365="">void</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> |</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365=""> null</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FF5874;--shiki-dark-font-style:italic;" data-v-f68ab365=""> null</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> uns</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> stores</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">map</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">it</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> i</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">    return</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> it</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">subscribe</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365="">_old</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D7DBE0;--shiki-dark-font-style:italic;" data-v-f68ab365=""> newValue</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">      values</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">[</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">i</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">]</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> newValue</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">      if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">sync</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">        innerModel</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">set</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> fn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">values</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">))</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">        return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">      }</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">      // 异步更新</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">      promise</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">        promise</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> ||</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365="">        Promise</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">resolve</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">then</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">          innerModel</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">set</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> fn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">values</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">))</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">          promise</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#FF5874;--shiki-dark-font-style:italic;" data-v-f68ab365=""> null</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">        }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    get</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> innerModel</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#BAEBE2;" data-v-f68ab365="">get</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    use</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> innerModel</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#BAEBE2;" data-v-f68ab365="">use</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    subscribe</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> innerModel</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#BAEBE2;" data-v-f68ab365="">subscribe</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    unsubscribe</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> innerModel</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#BAEBE2;" data-v-f68ab365="">unsubscribe</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    usePick</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f68ab365="">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> innerModel</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#BAEBE2;" data-v-f68ab365="">usePick</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">    stop</span><span style="--shiki-light:#D32F2F;--shiki-dark:#D6DEEB;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365="">      uns</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">forEach</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D7DBE0;" data-v-f68ab365="">un</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> un</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">());</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#5F7E97;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">  };</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">}</span></span></code></pre><p data-v-f68ab365="">至此，基于 Hooks 的状态共享方的实现介绍就结束了。</p><p data-v-f68ab365="">在最近的项目中，有需要状态共享的场景，我都选择了上述方式，在 Web 项目和小程序 Taro 项目中均能使用同一套实现，一直都比较顺利。</p><h2 id="%E4%BD%BF%E7%94%A8%E6%84%9F%E5%8F%97" data-v-f68ab365="">使用感受<a name="%E4%BD%BF%E7%94%A8%E6%84%9F%E5%8F%97" class="headerlink" href="#%E4%BD%BF%E7%94%A8%E6%84%9F%E5%8F%97" data-v-f68ab365=""></a></h2><p data-v-f68ab365="">最后总结一下目前这种方式的几个特点：</p><ul data-v-f68ab365=""><li data-v-f68ab365=""><p data-v-f68ab365="">实现简单，不引入其他概念，仅在 Hooks 的基础上结合发布/订阅模式，类 React 的场景都能使用，比如 Taro；</p></li><li data-v-f68ab365=""><p data-v-f68ab365="">使用简单，因为没有其他概念，直接调用 create 方法即可得到 state 的引用，调用 state 实例上的 use 方法即完成了组件和数据的绑定；</p></li><li data-v-f68ab365=""><p data-v-f68ab365="">类型友好，创建 state 时无需定义多余的类型，使用的时候也能较好地自动推导出类型；</p></li><li data-v-f68ab365=""><p data-v-f68ab365="">避免了 Hooks 的“闭包陷阱”，因为 state 的引用是恒定的，通过 state 的 get 方法总是能获取到最新的值：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f68ab365=""><code data-v-f68ab365=""><span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> countState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createSharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> App</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">  useEffect</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">    setInterval</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">      console</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">countState</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">get</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">())</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365=""> 1000</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">  }</span><span style="--shiki-light:#212121;--shiki-dark:#C792EA;" data-v-f68ab365="">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> [])</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic;" data-v-f68ab365="">  // return ...</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span></code></pre></li><li data-v-f68ab365=""><p data-v-f68ab365="">直接支持在多个 React 应用之间共享，在使用一些弹框的时候是比较容易出现多个 React 应用的场景：</p><pre class="shiki shiki-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627;" tabindex="0" data-v-f68ab365=""><code data-v-f68ab365=""><span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> countState</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> createSharedState</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> Content</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">  const</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> count</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#1976D2;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365=""> countState</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">use</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">  return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">{</span><span style="--shiki-light:#24292EFF;--shiki-light-font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic;" data-v-f68ab365="">count</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#C792EA;" data-v-f68ab365="">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">const</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365=""> A</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> ()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365=""> (</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">button</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic;" data-v-f68ab365="">    onClick</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365="">=</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">{</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD;" data-v-f68ab365="">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA;" data-v-f68ab365=""> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> {</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB;" data-v-f68ab365="">      Dialog</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic;" data-v-f68ab365="">.</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic;" data-v-f68ab365="">info</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">{</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">        title</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365=""> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D;" data-v-f68ab365="">Alert</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD;" data-v-f68ab365="">'</span><span style="--shiki-light:#212121;--shiki-dark:#7FDBCA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">        content</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA;" data-v-f68ab365="">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> &lt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C;" data-v-f68ab365="">Content</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365=""> /&gt;</span><span style="--shiki-light:#212121;--shiki-dark:#7FDBCA;" data-v-f68ab365="">,</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">      }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D3423E;" data-v-f68ab365="">}</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">  &gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">    open</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#CAECE6;" data-v-f68ab365="">button</span><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA;" data-v-f68ab365="">&gt;</span></span>
<span class="line" data-v-f68ab365=""><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB;" data-v-f68ab365="">);</span></span></code></pre></li><li data-v-f68ab365=""><p data-v-f68ab365="">支持在组件外的场景获取/更新数据</p></li><li data-v-f68ab365=""><p data-v-f68ab365="">在 SSR 的场景有较大局限性：state 是细碎、分散创建的，而且 state 的生命周期不是跟随 React 应用，导致无法用同构的方式编写 SSR 应用代码</p></li></ul><p data-v-f68ab365="">以上，便是本文的全部内容，实际上 Hooks 到目前流行了这么久，社区当中已有不少新型的状态共享实现方式，这里仅作为一种参考。</p><p data-v-f68ab365="">根据以上特点，这种方式有明显的优点，也有致命的缺陷（对于 SSR 而言），但在实际使用中，可以根据具体的情况来选择合适的方式。比如在 Taro2 的小程序应用中，无需关心 SSR，那么我更倾向于这种方式；如果在 SSR 的同构项目中，那么定还是老老实实选择 Redux。</p><p data-v-f68ab365="">总之，是多了一种选择，到底怎么选还得视具体情况而定。</p><!--]--></div></article><aside class="pointer-events-none fixed z-20 top-0 w-full h-full left-0 overscroll-contain transition-300 lg:pointer-events-auto lg:absolute lg:w-auto lg:bg-transparent lg:left-[calc(100%+clamp(6px,17.1875vw-176px,50px))]" data-v-f68ab365=""><nav class="overflow-y-auto text-foreground overscroll-contain bg-background w-74 max-w-4/5 h-full py-8 px-6 rounded-tl-xl rounded-bl-xl absolute top-0 transition-300 right-0 translate-x-full lg:p-0 lg:max-w-44 xl:max-w-50 lg:h-auto lg:max-h-[calc(100vh-130px)] lg:rounded-none lg:sticky lg:top-10 lg:right-auto lg:translate-x-0 lg:bg-transparent lg:ml-0" data-v-f68ab365=""><h2 class="mb-2 font-bold lg:hidden" data-v-f68ab365="">TABLE OF CONTENTS</h2><ul class="group/root" data-v-f68ab365=""><!--[--><li><a href="#%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8E%20React%20Hooks%20%E7%9A%84%E7%8A%B6%E6%80%81%E5%85%B1%E4%BA%AB" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="实现基于 React Hooks 的状态共享">实现基于 React Hooks 的状态共享</span></a><!----></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%84%9F%E5%8F%97" class="group/item text-foreground flex flex-nowrap items-center mb-1.5"><span class="hidden lg:block h-1 bg-foreground rounded-sm opacity-30 transition-300 shrink-0 group-hover/item:opacity-85" style="width:20px;margin-right:8px;"></span><span class="opacity-100 text-[color-mix(in_srgb,var(--foreground)_70%,transparent)] text-sm overflow-hidden text-ellipsis whitespace-nowrap transition-300 max-w-full flex-grow lg:opacity-0 lg:max-w-46 group-hover/root:opacity-100 group-hover/item:text-foreground lg:opacity-0" title="使用感受">使用感受</span></a><!----></li><!--]--></ul></nav></aside></div><hr class="border-border mt-10" data-v-f68ab365=""><div class="mt-10" data-v-f68ab365=""><div data-v-f68ab365=""><h2 class="text-xl font-bold mb-5"><a href="#comment" class="text-accent foreground-link">留言板</a></h2><div class="utterances-wrapper"></div></div></div><!--]--></main><footer class="text-center py-6 text-gray-500 dark:text-gray-400 text-sm"><div><span>© 2017-2025 Daief's Blog</span></div></footer><div></div></div><!--]--></div>
<script>window.__INITIAL_STATE__="{\"naiveUiStyles\":\"\"}"</script>
  

</body></html>